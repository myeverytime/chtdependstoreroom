<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>





	<title>ExcelFormat Library - CodeProject</title> 
	<link type="text/css" rel="stylesheet" 
href="ExcelFormat.aspx_files/CodeProject.css">
<link type="text/css" rel="stylesheet" 
href="ExcelFormat.aspx_files/ForumClassic.css">
<style type="text/css">
.list-socialbookmark {position: absolute;top: -90px;left: -5000px;z-index: 200;display: none;white-space:nowrap;background-color:white;padding:10px;border: solid 1px #999;}

</style>


	
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Description" content="ExcelFormat allows reading, writing, 
and editing of XLS (BIFF8 format) files using C++; Author: Martin Fuchs;
 Section: Office Development; Chapter: Enterprise Systems">
<meta name="Keywords" content="VC6, VC7, VC7.1, VC8.0, C++, Windows, 
Dev, Intermediate, VC9.0,Office Development,Enterprise Systems,Free 
source code, tutorials">
<meta name="Author" content="The Code Project">
<meta name="Rating" content="General">
<meta name="Robots" content="index, follow">
<meta name="Revisit-After" content="1 days">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6">
<link rel="alternate" type="application/rss+xml" title="CodeProject 
Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx">
<link rel="search" type="application/opensearchdescription+xml" 
title="CodeProject" 
href="http://www.codeproject.com/info/OpenSearch.xml">
	<!-- base -->
	<link rel="icon" href="http://www.codeproject.com/favicon.ico" 
type="image/ico">
<link rel="shortcut icon" href="http://www.codeproject.com/favicon.ico" 
type="image/ico">
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/bookmark.js"></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/rateitem.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
function LK(e) { var lounge  = document.getElementById("ctl00_TopNavBar_Lounge"); var soapbox = document.getElementById("ctl00_TopNavBar_Soapbox"); if (lounge && soapbox) {   lounge.style.display = e.ctrlKey? "none" : "inline";  soapbox.style.display = e.ctrlKey? "inline" : "none"; }}
function LC(e) {
 window.location.href = e.ctrlKey ? '/script/Forums/View.aspx?fid=1536756':'/Lounge.aspx';
 if (document.all) e.returnValue = false; else e.preventDefault();
}
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'menu2-dropdown') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

function MarkAns(MemberID,MsgID,gp,bp,mt,QID){
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\"  onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",6,"+QID.toString()+");\"%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 document.write(" &nbsp;"); document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\"  onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
}

function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"toolbar\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want this message removed?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new XMLHttpRequest();
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
var Selected = "-1";
function Pin(elm){
 CloseMsg(Selected);
 var wrk=elm.parentNode; if(wrk)wrk=wrk.firstChild;
 var fc=elm?elm.firstChild:null;
 if (wrk&&!wrk.pinned) {
  OpenMsg(wrk.name, true);wrk.pinned=true;fc.src='/script/forums/images/pinned.gif';fc.title='Pinned. Click to unpin'
 } else {
  wrk.pinned=false;CloseMsg(wrk.name); fc.src='/script/forums/images/pin.gif';fc.title='Click to pin message'
 }
 return false;
}
function CloseMsg(msgId) {
 if(!msgId||(msgId==''))return;
 var lnk=document.getElementsByName(msgId);
 if(lnk&&lnk.length>0&&lnk[0].pinned)return;
 var head=eval("document.getElementById('F" + msgId + "_h0')");
 if(head) head.className = head.className.replace("Sel", "UnSel");
 var body=eval("document.getElementById('F" + msgId + "_h1')");
 if(body) body.style.display = 'none';
}
function OpenMsg(msgId, keep) {
 if(!msgId||(msgId==''))return;
 var body=eval("document.getElementById('F" + msgId + "_h1')");
 if(body){
  var lnk=document.getElementsByName(msgId);
  if(lnk&&lnk.length>0&&lnk[0].pinned)keep=true;
  if(keep&&body.style.display!='none')return;
  if(body.style.display=='none') body.style.display='';
  else body.style.display = 'none';
 }
 var head=eval("document.getElementById('F" + msgId + "_h0')");
 if (head) head.className = head.className.replace('UnSel', 'Sel');
 if(body&&head&&body.style.display!='none'){
  document.body.scrollTop = getRealPos(head, 'Top') - document.body.clientHeight/10;
  EnsureMessageVisible(msgId, true);
 }
}

function SwitchMessage(e, msgId)
{
  if (msgId) msgId=msgId.toString();
  else {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    if(target.pinned){Selected='';return false;}
    msgId=target.name;
  }
  CloseMsg(Selected)
  if(Selected==msgId) Selected='';
  else { OpenMsg(msgId, false); Selected=msgId;}
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}


//]]>
</script>

<script src="ExcelFormat.aspx_files/ga.js" async="" type="text/javascript"></script></head><body>

<a href="#Main"><img alt="Click here to Skip to main content" 
class="access-link" src="ExcelFormat.aspx_files/t.gif"></a>

<div style="width: 100%; padding: 0px; margin: 0px;">
	<div style="width: 100%;">

<table class="nav-memberbar" width="100%" cellpadding="5" 
cellspacing="0">
<tbody><tr>
<td style="font-weight: bold;">7,044,197 members and growing! (14,729 
online)</td>
<td align="right">

<div id="ctl00_MemberMenu_LoggedOnOptions" class="MemberNavBarText">
	
<a id="ctl00_MemberMenu_MyProfile" 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=1534029">robustwell</a>
 | 
<a id="ctl00_MemberMenu_MySettings" 
href="http://www.codeproject.com/script/Membership/Modify.aspx">Settings</a>
 |

<a id="ctl00_MemberMenu_MyCodeProject" 
href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><b>Watched
 Items</b></a> |
<a id="ctl00_MemberMenu_MyBookmarks" 
href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2">Bookmarks</a>
 |
<a id="ctl00_MemberMenu_MyArticles" 
href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1534029">My
 Articles</a> |

<a id="ctl00_MemberMenu_Signout" 
href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2foffice%2fExcelFormat.aspx">Sign
 out</a>

</div>



</td>
</tr>
</tbody></table></div>
	<table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr>
		<td class="header"><a href="http://www.codeproject.com/"><img 
id="ctl00_Logo" title="The Code Project" 
src="ExcelFormat.aspx_files/logo225x90.gif" alt="Home" 
style="border-width: 0px;"></a></td>
		<td class="header align-right" width="100%"><script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d13133%26adcrid%3d11628%26obid%3d42504%26obtid%3d2%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20id%3d%22ctl00_TopAd%22%20src%3d%22%2fimages%2ft.gif%22%20width%3d%22728px%22%20height%3d%2290px%22%20alt%3d%22%22%20border%3d%220%22%2f%3e%3c%2fa%3e"));</script><a
 
href="http://www.codeproject.com/Redir.aspx?adid=13133&amp;adcrid=11628&amp;obid=42504&amp;obtid=2&amp;way=ban"
 target="_blank" rel="nofollow"><img id="ctl00_TopAd" 
src="ExcelFormat.aspx_files/ServeImg_002.png" alt="" width="728px" 
border="0" height="90px"></a>
		</td>
	</tr></tbody></table>
	

<div class="navbar clearfix">
<ul id="nav">

<li><a href="http://www.codeproject.com/">Home</a></li>


<li><a id="ctl00_TopNavBar_Art" class="down" 
href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</a>

	<ul>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" 
href="http://www.codeproject.com/info/search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" 
href="http://www.codeproject.com/script/Articles/Latest.aspx">Latest 
Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" 
href="http://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest
 Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" 
href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=4">Top
 Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" 
href="http://www.codeproject.com/info/search.aspx?aidlst=152&amp;sa_us=True">Beginner
 Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" 
href="http://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical
 Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly" 
href="http://www.codeproject.com/info/Submit.aspx">Post an Article</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostTipTrick" class="fly" 
href="http://www.codeproject.com/script/Answers/Post.aspx?new=tipntrick">Post
 Tip &amp; Trick</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly break" 
href="http://www.codeproject.com/script/Articles/BlogFeed.aspx">Post 
your Blog</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" 
href="http://www.codeproject.com/info/Submit.aspx">Posting/Update 
Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly" 
href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article
 Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtTopicList" class="fly last" 
href="http://www.codeproject.com/script/Content/SiteMap.aspx">Topic List</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_Answers" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest">Quick
 Answers</a>
	<ul>
		<li><a id="ctl00_TopNavBar_QAAsk" class="fly" 
href="http://www.codeproject.com/script/Answers/Post.aspx?new=question">Ask
 a Question</a></li>
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View
 Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly break" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest">View
 All Questions</a></li>
		
		
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest&amp;tags=81">C#</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest&amp;tags=85">ASP.NET</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest&amp;tags=78">C++</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest&amp;tags=842">VB.NET</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" 
href="http://www.codeproject.com/script/Answers/List.aspx?tab=latest&amp;tags=98">.NET</a></li>
			
	</ul>

</li>



<li><a id="ctl00_TopNavBar_MessageBoards" class="down" 
href="http://www.codeproject.com/script/Forums/List.aspx">Message Boards</a>

	<ul>
		<li><a class="fly" 
href="http://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  
WTL / STL</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / 
C++ / MFC</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed
 C++/CLI</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1648/COM.aspx">COM</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware
 &amp; Devices</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1004117/LINQ.aspx">LINQ</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET 
Framework</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1644/System-Admin.aspx">System 
Admin</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1004257/Silverlight.aspx">Silverlight</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1725/General-Database.aspx">General
 Database</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1540733/Sharepoint.aspx">Sharepoint</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual 
Basic</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1640/Web-Development.aspx">Web 
Development</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1004114/WPF-WCF-WF.aspx">WPF / 
WCF / WF</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/3421/XML-XSL.aspx">XML / XSL</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1642/General-IT-Issues.aspx">General
 IT Issues</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1645/Site-Bugs-Suggestions.aspx">Site
 Bugs / Suggestions</a></li>
<li><a class="fly" 
href="http://www.codeproject.com/Forums/1536756/The-Soapbox-2-0.aspx">The
 Soapbox 2.0</a></li>

		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="last" 
href="http://www.codeproject.com/script/Forums/List.aspx">All Message 
Boards...</a></li>
	</ul>

</li>



<li><a id="ctl00_TopNavBar_Job" 
href="http://www.codeproject.com/script/Jobs/List.aspx">Job Board</a>
	<ul>
		<li><a id="ctl00_TopNavBar_JobLatest" class="fly" 
href="http://www.codeproject.com/script/Jobs/List.aspx">Latest</a></li>
		<li><a id="ctl00_TopNavBar_JobSearch" class="fly" 
href="http://www.codeproject.com/script/Jobs/Search.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_JobPost" class="fly" 
href="http://www.codeproject.com/script/Jobs/Edit.aspx">Post a Job</a></li>
		<li><a id="ctl00_TopNavBar_JobFaq" class="fly last" 
href="http://www.codeproject.com/KB/FAQs/JobBoardFAQ.aspx">FAQ and 
Pricing</a></li>
	</ul>

</li>




<li><a id="ctl00_TopNavBar_Cat" 
href="http://www.codeproject.com/script/Catalog/List.aspx">Catalog</a>
	<ul>
		<li><a id="ctl00_TopNavBar_CatLatest" class="fly" 
href="http://www.codeproject.com/script/Catalog/List.aspx?ctls=DatePostedDescending">Latest</a></li>
		<li><a id="ctl00_TopNavBar_CatSearch" class="fly" 
href="http://www.codeproject.com/script/Catalog/List.aspx">Search</a></li>
		<li><a id="ctl00_TopNavBar_CatPost" class="fly" 
href="http://www.codeproject.com/script/Catalog/Edit.aspx">Post a 
Catalog Item</a></li>
		<li><a id="ctl00_TopNavBar_CatFaq" class="fly last" 
href="http://www.codeproject.com/KB/FAQs/CatalogFAQ.aspx">FAQ and 
Pricing</a></li>
	</ul>

</li>






<li><a id="ctl00_TopNavBar_Help" 
href="http://www.codeproject.com/KB/FAQs/">Help!</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" 
href="http://www.codeproject.com/info/guide.aspx">What is 'The Code 
Project'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly" 
href="http://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly" 
href="http://www.codeproject.com/script/Forums/List.aspx">Post a 
Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" 
href="http://www.codeproject.com/script/Content/SiteMap.aspx">Site 
Directory</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly last" 
href="http://www.codeproject.com/info/about.aspx">About Us</a></li>
	</ul>

</li>


<li style="float: right;">
<a style="display: inline;" id="ctl00_TopNavBar_Lounge" 
href="http://www.codeproject.com/Lounge.aspx">Lounge</a>
<a id="ctl00_TopNavBar_Soapbox" href="javascript:void();" 
style="display: none;">Soapbox</a>

</li>

</ul>

</div>
	<div style="width: 100%;"><a name="_top"></a>
		<table id="ctl00_ArticleTopHeader_HeaderTable" class="ArticleHeader 
extended" cellpadding="3">
	<tbody><tr valign="top">
		<td class="small-text">
	
	<a id="ctl00_ArticleTopHeader_ChapterLink" 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise
 Systems</a> »
	<a id="ctl00_ArticleTopHeader_SectionLink" 
href="http://www.codeproject.com/KB/office/">Office Development</a> »
	<a id="ctl00_ArticleTopHeader_SubsectionLink" 
href="http://www.codeproject.com/KB/office/index.aspx?#Office%20Development%20-%20Microsoft%20Excel">Microsoft
 Excel</a>
	
	<span id="ctl00_ArticleTopHeader_SkillLevel" 
class="ArticleIntermediate">&nbsp;&nbsp;&nbsp; Intermediate</span> 
	<span id="ctl00_ArticleTopHeader_LicenceTerms" class="small-text" 
style="margin-left: 40px;">License: <a 
href="http://www.codeproject.com/info/cpol10.aspx">The Code Project Open
 License (CPOL)</a></span>
	<br>
	<br>
	<h1 id="ctl00_ArticleTopHeader_ArticleTitle">ExcelFormat Library</h1>
	
		<b>By <a 
href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=155624">Martin
 Fuchs</a></b><br>
	
	<br>
    <span id="ctl00_ArticleTopHeader_ArticleDescr">ExcelFormat allows 
reading, writing, and editing of XLS (BIFF8 format) files using C++</span>
</td>
		<td style="width: 210px;">
	<span id="ctl00_ArticleTopHeader_ArticleAttributes" class="small-text">C++
 (VC6, VC7, VC7.1, VC8.0, VC9.0), Windows, Dev</span>
	<table style="margin: 8px 0pt 0pt; padding: 0pt;" class="small-text">
	
	<tbody><tr><td>Revision:</td><td><b><b>15</b> (<a 
href="http://www.codeproject.com/script/Articles/ListVersions.aspx?aid=42504">See
 All</a>)</b></td></tr>
	
	<tr><td>Posted:</td><td><b>20 Sep 2009</b></td></tr>
	
	<tr><td>Updated:</td><td><b>12 Jan 2010</b></td></tr>
	
	<tr><td>Views:</td><td><b>21,463</b></td></tr>
	
	<tr><td>Bookmarked:</td><td><b>134 times</b></td></tr>
	
	
	
	
	</tbody></table>
</td>
	</tr>
</tbody></table>

	</div>
</div>

<div>

<div id="ctl00_LHNavBar" class="nav-left">

	

<div class="blank-background">
<div class="announce-header">Announcements</div>
<div class="announce-content">
<table cellpadding="2">











<tbody><tr valign="middle"><td><img 
id="ctl00_Announcements_News_ctl00_Img" 
src="ExcelFormat.aspx_files/visual-studio-2010-logo.png" alt="News" 
style="height: 24px; width: 24px; border-width: 0px;" align="middle"></td>
<td><a id="ctl00_Announcements_News_ctl00_Link" 
href="http://www.codeproject.com/Competitions/408/Visual-Studio-Tips-Tricks-Competition.aspx">Post
 a VS2010 Tip or Trick, Win a Zune HD</a></td></tr>

<tr valign="middle"><td><img id="ctl00_Announcements_News_ctl01_Img" 
src="ExcelFormat.aspx_files/11875.png" alt="News" style="height: 24px; 
width: 24px; border-width: 0px;" align="middle"></td>
<td><a id="ctl00_Announcements_News_ctl01_Link" 
href="http://www.codeproject.com/Feature/TechSummit/">VS2010 Tech Summit
  Free, on-demand</a></td></tr>

<tr valign="middle"><td><img id="ctl00_Announcements_News_ctl02_Img" 
src="ExcelFormat.aspx_files/MonthlyComp.png" alt="News" style="height: 
24px; width: 24px; border-width: 0px;" align="middle"></td>
<td><a id="ctl00_Announcements_News_ctl02_Link" 
href="http://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Monthly
 Competition</a></td></tr>




</tbody></table>
</div>
</div>
	

<div class="blank-background">
<div class="announce-header">The Daily Insider</div>
<div class="announce-content">
<table cellpadding="2">


<tbody><tr valign="middle"><td></td>
<td><a id="ctl00_News_News_ctl00_Link" 
href="http://www.networkworld.com/news/2010/050610-hacker-develops-multi-platform-rootkit-for.html">Hacker
 develops multi-platform rootkit for ATMs</a></td></tr>


</tbody></table>

Daily IT news: <a id="ctl00_News_Subscribe" 
href="http://www.codeproject.com/Feature/Insider/">Signup now</a>.
</div>
</div>		
	
<div id="Th">
</div>

	
	
	<div id="SectionMenu">
<div class="menu1">Articles</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1" 
onclick="return ToggleMenu('Chapter1');">Desktop Development</a></div>
<div class="menu2-dropdown" id="Chapter1" style="display: none;">
<div class="menu3" id="Section1"><a 
href="http://www.codeproject.com/KB/buttons/">Button Controls</a></div>
<div class="menu3" id="Section15"><a 
href="http://www.codeproject.com/KB/clipboard/">Clipboard</a></div>
<div class="menu3" id="Section2"><a 
href="http://www.codeproject.com/KB/combobox/">Combo &amp; List Boxes</a></div>
<div class="menu3" id="Section67"><a 
href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</a></div>
<div class="menu3" id="Section107"><a 
href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</a></div>
<div class="menu3" id="Section16"><a 
href="http://www.codeproject.com/KB/docview/">Document / View</a></div>
<div class="menu3" id="Section4"><a 
href="http://www.codeproject.com/KB/edit/">Edit Controls</a></div>
<div class="menu3" id="Section17"><a 
href="http://www.codeproject.com/KB/files/">Files and Folders</a></div>
<div class="menu3" id="Section3"><a 
href="http://www.codeproject.com/KB/grid/">Grid &amp; Data Controls</a></div>
<div class="menu3" id="Section5"><a 
href="http://www.codeproject.com/KB/list/">List Controls</a></div>
<div class="menu3" id="Section6"><a 
href="http://www.codeproject.com/KB/menus/">Menus</a></div>
<div class="menu3" id="Section14"><a 
href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</a></div>
<div class="menu3" id="Section18"><a 
href="http://www.codeproject.com/KB/printing/">Printing</a></div>
<div class="menu3" id="Section95"><a 
href="http://www.codeproject.com/KB/progress/">Progress Controls</a></div>
<div class="menu3" id="Section11"><a 
href="http://www.codeproject.com/KB/selection/">Selection Controls</a></div>
<div class="menu3" id="Section19"><a 
href="http://www.codeproject.com/KB/shell/">Shell and IE programming</a></div>
<div class="menu3" id="Section68"><a 
href="http://www.codeproject.com/KB/smart/">Smart Client</a></div>
<div class="menu3" id="Section8"><a 
href="http://www.codeproject.com/KB/splitter/">Splitter Windows</a></div>
<div class="menu3" id="Section9"><a 
href="http://www.codeproject.com/KB/static/">Static &amp; Panel Controls</a></div>
<div class="menu3" id="Section10"><a 
href="http://www.codeproject.com/KB/statusbar/">Status Bar</a></div>
<div class="menu3" id="Section7"><a 
href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property Pages</a></div>
<div class="menu3" id="Section12"><a 
href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
windows</a></div>
<div class="menu3" id="Section13"><a 
href="http://www.codeproject.com/KB/tree/">Tree Controls</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2" 
onclick="return ToggleMenu('Chapter2');">Web Development</a></div>
<div class="menu2-dropdown" id="Chapter2" style="display: none;">
<div class="menu3" id="Section70"><a 
href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</a></div>
<div class="menu3" id="Section27"><a 
href="http://www.codeproject.com/KB/applications/">Applications &amp; 
Tools</a></div>
<div class="menu3" id="Section85"><a 
href="http://www.codeproject.com/KB/asp/">ASP</a></div>
<div class="menu3" id="Section89"><a 
href="http://www.codeproject.com/KB/aspnet/">ASP.NET</a></div>
<div class="menu3" id="Section28"><a 
href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</a></div>
<div class="menu3" id="Section38"><a 
href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</a></div>
<div class="menu3" id="Section29"><a 
href="http://www.codeproject.com/KB/web-cache/">Caching</a></div>
<div class="menu3" id="Section91"><a 
href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
Images</a></div>
<div class="menu3" id="Section25"><a 
href="http://www.codeproject.com/KB/scripting/">Client side scripting</a></div>
<div class="menu3" id="Section30"><a 
href="http://www.codeproject.com/KB/custom-controls/">Custom Controls</a></div>
<div class="menu3" id="Section23"><a 
href="http://www.codeproject.com/KB/HTML/">HTML / CSS</a></div>
<div class="menu3" id="Section24"><a 
href="http://www.codeproject.com/KB/ISAPI/">ISAPI</a></div>
<div class="menu3" id="Section33"><a 
href="http://www.codeproject.com/KB/server-management/">Site &amp; 
Server Management</a></div>
<div class="menu3" id="Section34"><a 
href="http://www.codeproject.com/KB/session/">Session State</a></div>
<div class="menu3" id="Section113"><a 
href="http://www.codeproject.com/KB/silverlight/">Silverlight</a></div>
<div class="menu3" id="Section36"><a 
href="http://www.codeproject.com/KB/trace/">Trace and Logs</a></div>
<div class="menu3" id="Section31"><a 
href="http://www.codeproject.com/KB/user-controls/">User Controls</a></div>
<div class="menu3" id="Section37"><a 
href="http://www.codeproject.com/KB/validation/">Validation</a></div>
<div class="menu3" id="Section35"><a 
href="http://www.codeproject.com/KB/viewstate/">View State</a></div>
<div class="menu3" id="Section26"><a 
href="http://www.codeproject.com/KB/WAP/">WAP / WML</a></div>
<div class="menu3" id="Section32"><a 
href="http://www.codeproject.com/KB/web-security/">Web Security</a></div>
<div class="menu3" id="Section20"><a 
href="http://www.codeproject.com/KB/webservices/">Web Services</a></div>
<div class="menu3" id="Section144"><a 
href="http://www.codeproject.com/KB/PHP/">PHP</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=14" 
onclick="return ToggleMenu('Chapter14');">Mobile Development</a></div>
<div class="menu2-dropdown" id="Chapter14" style="display: none;">
<div class="menu3" id="Section146"><a 
href="http://www.codeproject.com/KB/iPhone/">iPhone</a></div>
<div class="menu3" id="Section147"><a 
href="http://www.codeproject.com/KB/android/">Android</a></div>
<div class="menu3" id="Section148"><a 
href="http://www.codeproject.com/KB/windows/">Windows</a></div>
<div class="menu3" id="Section149"><a 
href="http://www.codeproject.com/KB/palm/">Palm</a></div>
<div class="menu3" id="Section150"><a 
href="http://www.codeproject.com/KB/miscellaneous/">Miscellaneous</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9" 
onclick="return ToggleMenu('Chapter9');">Enterprise Systems</a></div>
<div class="menu2-dropdown" id="Chapter9">
<div class="menu3" id="Section98"><a 
href="http://www.codeproject.com/KB/MCMS/">Content Management Server</a></div>
<div class="menu3" id="Section99"><a 
href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk Server</a></div>
<div class="menu3" id="Section102"><a 
href="http://www.codeproject.com/KB/exchange/">Microsoft Exchange</a></div>
<div class="menu3 selected" id="Section90"><a 
href="http://www.codeproject.com/KB/office/">Office Development</a></div>
<div class="menu3" id="Section101"><a 
href="http://www.codeproject.com/KB/sharepoint/">SharePoint Server</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4" 
onclick="return ToggleMenu('Chapter4');">Database</a></div>
<div class="menu2-dropdown" id="Chapter4" style="display: none;">
<div class="menu3" id="Section66"><a 
href="http://www.codeproject.com/KB/database/">Database</a></div>
<div class="menu3" id="Section100"><a 
href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
Services</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3" 
onclick="return ToggleMenu('Chapter3');">Multimedia</a></div>
<div class="menu2-dropdown" id="Chapter3" style="display: none;">
<div class="menu3" id="Section42"><a 
href="http://www.codeproject.com/KB/audio-video/">Audio and Video</a></div>
<div class="menu3" id="Section44"><a 
href="http://www.codeproject.com/KB/directx/">DirectX</a></div>
<div class="menu3" id="Section46"><a 
href="http://www.codeproject.com/KB/GDI/">GDI</a></div>
<div class="menu3" id="Section47"><a 
href="http://www.codeproject.com/KB/GDI-plus/">GDI+</a></div>
<div class="menu3" id="Section43"><a 
href="http://www.codeproject.com/KB/graphics/">General Graphics</a></div>
<div class="menu3" id="Section45"><a 
href="http://www.codeproject.com/KB/openGL/">OpenGL</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5" 
onclick="return ToggleMenu('Chapter5');">Languages</a></div>
<div class="menu2-dropdown" id="Chapter5" style="display: none;">
<div class="menu3" id="Section71"><a 
href="http://www.codeproject.com/KB/cpp/">C / C++ Language</a></div>
<div class="menu3" id="Section72"><a 
href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</a></div>
<div class="menu3" id="Section93"><a 
href="http://www.codeproject.com/KB/cs/">C#</a></div>
<div class="menu3" id="Section78"><a 
href="http://www.codeproject.com/KB/msil/">MSIL</a></div>
<div class="menu3" id="Section86"><a 
href="http://www.codeproject.com/KB/vbscript/">VBScript</a></div>
<div class="menu3" id="Section87"><a 
href="http://www.codeproject.com/KB/vb/">VB.NET</a></div>
<div class="menu3" id="Section115"><a 
href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</a></div>
<div class="menu3" id="Section77"><a 
href="http://www.codeproject.com/KB/net-languages/">Other .NET Languages</a></div>
<div class="menu3" id="Section21"><a 
href="http://www.codeproject.com/KB/XML/">XML</a></div>
<div class="menu3" id="Section96"><a 
href="http://www.codeproject.com/KB/java/">Java</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8" 
onclick="return ToggleMenu('Chapter8');">Platforms, Frameworks &amp; 
Libraries</a></div>
<div class="menu2-dropdown" id="Chapter8" style="display: none;">
<div class="menu3" id="Section83"><a 
href="http://www.codeproject.com/KB/atl/">ATL</a></div>
<div class="menu3" id="Section117"><a 
href="http://www.codeproject.com/KB/MFC/">MFC</a></div>
<div class="menu3" id="Section88"><a 
href="http://www.codeproject.com/KB/stl/">STL</a></div>
<div class="menu3" id="Section84"><a 
href="http://www.codeproject.com/KB/wtl/">WTL</a></div>
<div class="menu3" id="Section49"><a 
href="http://www.codeproject.com/KB/COM/">COM / COM+</a></div>
<div class="menu3" id="Section76"><a 
href="http://www.codeproject.com/KB/dotnet/">.NET Framework</a></div>
<div class="menu3" id="Section92"><a 
href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; OS</a></div>
<div class="menu3" id="Section108"><a 
href="http://www.codeproject.com/KB/vista/">Vista API</a></div>
<div class="menu3" id="Section110"><a 
href="http://www.codeproject.com/KB/vista-security/">Vista Security</a></div>
<div class="menu3" id="Section82"><a 
href="http://www.codeproject.com/KB/cross-platform/">Cross Platform</a></div>
<div class="menu3" id="Section69"><a 
href="http://www.codeproject.com/KB/game/">Game Development</a></div>
<div class="menu3" id="Section73"><a 
href="http://www.codeproject.com/KB/mobile/">Mobile Development</a></div>
<div class="menu3" id="Section106"><a 
href="http://www.codeproject.com/KB/WC/">Windows CardSpace</a></div>
<div class="menu3" id="Section103"><a 
href="http://www.codeproject.com/KB/WCF/">Windows Communication 
Foundation</a></div>
<div class="menu3" id="Section104"><a 
href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
Foundation</a></div>
<div class="menu3" id="Section105"><a 
href="http://www.codeproject.com/KB/WF/">Windows Workflow Foundation</a></div>
<div class="menu3" id="Section119"><a 
href="http://www.codeproject.com/KB/library/">Libraries</a></div>
<div class="menu3" id="Section122"><a 
href="http://www.codeproject.com/KB/powershell/">Windows Powershell</a></div>
<div class="menu3" id="Section123"><a 
href="http://www.codeproject.com/KB/linq/">LINQ</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6" 
onclick="return ToggleMenu('Chapter6');">General Programming</a></div>
<div class="menu2-dropdown" id="Chapter6" style="display: none;">
<div class="menu3" id="Section57"><a 
href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; Recipes</a></div>
<div class="menu3" id="Section64"><a 
href="http://www.codeproject.com/KB/bugs/">Bugs &amp; Workarounds</a></div>
<div class="menu3" id="Section79"><a 
href="http://www.codeproject.com/KB/collections/">Collections</a></div>
<div class="menu3" id="Section56"><a 
href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
Security</a></div>
<div class="menu3" id="Section50"><a 
href="http://www.codeproject.com/KB/datetime/">Date and Time</a></div>
<div class="menu3" id="Section52"><a 
href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</a></div>
<div class="menu3" id="Section80"><a 
href="http://www.codeproject.com/KB/exception/">Exception Handling</a></div>
<div class="menu3" id="Section81"><a 
href="http://www.codeproject.com/KB/locale/">Localisation</a></div>
<div class="menu3" id="Section53"><a 
href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</a></div>
<div class="menu3" id="Section54"><a 
href="http://www.codeproject.com/KB/tips/">Programming Tips</a></div>
<div class="menu3" id="Section55"><a 
href="http://www.codeproject.com/KB/string/">String handling</a></div>
<div class="menu3" id="Section22"><a 
href="http://www.codeproject.com/KB/IP/">Internet / Network</a></div>
<div class="menu3" id="Section58"><a 
href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
IPC</a></div>
<div class="menu3" id="Section59"><a 
href="http://www.codeproject.com/KB/winhelp/">WinHelp / HTMLHelp</a></div>
<div class="menu3" id="Section141"><a 
href="http://www.codeproject.com/KB/answers/">Uncategorised Quick 
Answers</a></div>
<div class="menu3" id="Section151"><a 
href="http://www.codeproject.com/KB/Parallel_Programming/">Parallel 
Programming</a></div>
<div class="menu3" id="Section152"><a 
href="http://www.codeproject.com/KB/TipsnTricks/">Uncategorised Tips and
 Tricks</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10" 
onclick="return ToggleMenu('Chapter10');">Graphics / Design</a></div>
<div class="menu2-dropdown" id="Chapter10" style="display: none;">
<div class="menu3" id="Section40"><a 
href="http://www.codeproject.com/KB/expression/">Expression</a></div>
<div class="menu3" id="Section114"><a 
href="http://www.codeproject.com/KB/usability/">Usability</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11" 
onclick="return ToggleMenu('Chapter11');">Development Lifecycle</a></div>
<div class="menu2-dropdown" id="Chapter11" style="display: none;">
<div class="menu3" id="Section51"><a 
href="http://www.codeproject.com/KB/debug/">Debug Tips</a></div>
<div class="menu3" id="Section39"><a 
href="http://www.codeproject.com/KB/architecture/">Design and 
Architecture</a></div>
<div class="menu3" id="Section112"><a 
href="http://www.codeproject.com/KB/install/">Installation</a></div>
<div class="menu3" id="Section41"><a 
href="http://www.codeproject.com/KB/work/">Work Issues</a></div>
<div class="menu3" id="Section128"><a 
href="http://www.codeproject.com/KB/testing/">Testing and QA</a></div>
<div class="menu3" id="Section126"><a 
href="http://www.codeproject.com/KB/codegen/">Code Generation</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7" 
onclick="return ToggleMenu('Chapter7');">General Reading</a></div>
<div class="menu2-dropdown" id="Chapter7" style="display: none;">
<div class="menu3" id="Section60"><a 
href="http://www.codeproject.com/KB/books/">Book Chapters</a></div>
<div class="menu3" id="Section61"><a 
href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</a></div>
<div class="menu3" id="Section109"><a 
href="http://www.codeproject.com/KB/hardware-review/">Hardware Reviews</a></div>
<div class="menu3" id="Section63"><a 
href="http://www.codeproject.com/KB/interviews/">Interviews</a></div>
<div class="menu3" id="Section62"><a 
href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</a></div>
<div class="menu3" id="Section48"><a 
href="http://www.codeproject.com/KB/system/">Hardware &amp; System</a></div>
<div class="menu3" id="Section136"><a 
href="http://www.codeproject.com/KB/Blogs/">Uncategorised Technical 
Blogs</a></div>
<div class="menu3" id="Section145"><a 
href="http://www.codeproject.com/KB/FAQs/">CodeProject FAQs</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12" 
onclick="return ToggleMenu('Chapter12');">Third Party Products</a></div>
<div class="menu2-dropdown" id="Chapter12" style="display: none;">
<div class="menu3" id="Section65"><a 
href="http://www.codeproject.com/KB/showcase/">Product Showcase</a></div>
<div class="menu3" id="Section124"><a 
href="http://www.codeproject.com/KB/solution-center/">Solution Center</a></div>
</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=13" 
onclick="return ToggleMenu('Chapter13');">Mentor Resources</a></div>
<div class="menu2-dropdown" id="Chapter13" style="display: none;">
<div class="menu3" id="Section140"><a 
href="http://www.codeproject.com/KB/mentor/">Author Resources</a></div>
</div>
</div>
<div style="margin-top: 5px;"></div>
<div class="menu1">Services</div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Catalog/List.aspx">Product 
Catalog</a></div>
<div class="menu2"><a 
href="http://www.codeproject.com/script/Jobs/List.aspx">Job Board</a></div>
<div class="menu2"><a href="http://www.codeproject.com/Services/Addins/">CodeProject
 VS2008 Addin</a></div>
<div style="margin-top: 5px;"></div>
<div class="menu1">Feature Zones</div>
<div class="menu2"><a href="http://www.codeproject.com/kb/Showcase/">Product
 Showcase</a></div>
<div class="menu2"><a 
href="http://www.codeproject.com/Zones/WhitePapers/">WhitePapers / 
Webcasts</a></div>
<div class="menu2"><a 
href="http://www.codeproject.com/Redir.aspx?adid=14085&amp;obid=0&amp;obtid=0">.NET
 Dev Library</a></div>
<div class="menu2"><a 
href="http://www.codeproject.com/Redir.aspx?adid=14347&amp;obid=0&amp;obtid=0">ASP.NET
 4 Web Hosting</a></div>
<div style="margin-top: 5px;"></div>


	<div style="margin: auto; width: 150px;"><div id="ctl00_LeftHandAd" 
style="display: inline-block; width: 150px; height: 80px;" title=""><iframe
 src="ExcelFormat.aspx_files/ServeFlash.htm" width="150px" 
frameborder="0" height="80px" scrolling="no"></iframe></div>
	</div>
	
	<div style="margin: 10px auto auto; width: 160px;"><script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d13687%26adcrid%3d12373%26obid%3d42504%26obtid%3d2%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20id%3d%22ctl00_TowerAd%22%20src%3d%22%2fimages%2ft.gif%22%20width%3d%22160px%22%20height%3d%22600px%22%20alt%3d%22%22%20border%3d%220%22%2f%3e%3c%2fa%3e"));</script><a
 
href="http://www.codeproject.com/Redir.aspx?adid=13687&amp;adcrid=12373&amp;obid=42504&amp;obtid=2&amp;way=ban"
 target="_blank" rel="nofollow"><img id="ctl00_TowerAd" 
src="ExcelFormat.aspx_files/ServeImg.png" alt="" width="160px" 
border="0" height="600px"></a>
	</div>
</div>

<div id="ctl00_ArticlePane" class="container-article borders-left-nav">

	
<table class="nav-search extended" cellspacing="0">
<tbody><tr>
<td width="100%">&nbsp;</td>
<td style="white-space: nowrap; width: 60%;" valign="middle" 
align="right">
	<form method="get" action="/info/search.aspx" name="Search" 
style="margin: 0pt;">
	<b>Search &nbsp;</b>
	<input class="small-text " name="artkw" style="width: 200px;">
	<select class="small-text offblack" style="font-weight: bold;" 
name="sbo">
	<option value="kw" selected="selected">Articles / Quick Answers</option>
<option value="fm">Messages</option>
<option value="s">Jobs</option>
<option value="ctlk">Product Catalog</option>

	</select>
	<input class="button small-text" value=" Go! " type="submit"> &nbsp;
	</form>
</td>
<td class="tiny-text" style="white-space: nowrap;">
	
	<a href="http://www.codeproject.com/info/search.aspx">Advanced Search</a><br>
	
	
	<a id="ctl00_SearchBarCtrl_AddToIESearchLnk" 
href="http://www.codeproject.com/">Add to IE Search</a>
</td>
</tr>
</tbody></table>

	<a name="Main"></a>
	<span id="ctl00_ResultMessage"></span>
	
	
    
	<div id="ctl00_ArtDiv">
	<table border="0" cellpadding="0" cellspacing="0">	
	<tbody><tr valign="top">
		<td valign="top" width="100%">
		    
<table>

</table>



			
<div class="small-text">
<img src="ExcelFormat.aspx_files/print.gif" alt="print" 
style="vertical-align: middle;" width="16px" height="16px"><a 
id="ctl00_ArticleHeaderLinks_PrintLnk" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?display=Print">Print
 Friendly</a> &nbsp;
	


<span id="SBI"><img src="ExcelFormat.aspx_files/add.gif" 
id="ctl00_ArticleHeaderLinks_AddTo_Img" alt="add" style="vertical-align:
 middle;" width="16" height="16">
<a href="#">Share</a></span>
<div style="left: 246.5px; top: 326.8px;" id="ATD" 
class="list-socialbookmark"><div><a class="AddTo" title="Add this page 
to Digg" onclick="return socialLinks.addto(0);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Digg.png" width="16px" 
align="absmiddle" border="0" height="16px"> Digg</a> </div><div><a 
class="AddTo" title="Add this page to Del.icio.us" onclick="return 
socialLinks.addto(1);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Delicious.png" width="16px" 
align="absmiddle" border="0" height="16px"> Del.icio.us</a> </div><div><a
 class="AddTo" title="Add this page to Google" onclick="return 
socialLinks.addto(2);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Google.png" width="16px" 
align="absmiddle" border="0" height="16px"> Google</a> </div><div><a 
class="AddTo" title="Add this page to Windows Live" onclick="return 
socialLinks.addto(3);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Live.png" width="16px" 
align="absmiddle" border="0" height="16px"> Windows Live</a> </div><div><a
 class="AddTo" title="Add this page to Technorati" onclick="return 
socialLinks.addto(4);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Technorati.png" width="16px" 
align="absmiddle" border="0" height="16px"> Technorati</a> </div><div><a
 class="AddTo" title="Add this page to Blink" onclick="return 
socialLinks.addto(5);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Blink.png" width="16px" 
align="absmiddle" border="0" height="16px"> Blink</a> </div><div><a 
class="AddTo" title="Add this page to Facebook" onclick="return 
socialLinks.addto(6);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Facebook.png" width="16px" 
align="absmiddle" border="0" height="16px"> Facebook</a> </div><div><a 
class="AddTo" title="Add this page to Furl" onclick="return 
socialLinks.addto(7);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Furl.png" width="16px" 
align="absmiddle" border="0" height="16px"> Furl</a> </div><div><a 
class="AddTo" title="Add this page to Simpy" onclick="return 
socialLinks.addto(8);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Simpy.png" width="16px" 
align="absmiddle" border="0" height="16px"> Simpy</a> </div><div><a 
class="AddTo" title="Add this page to Reddit" onclick="return 
socialLinks.addto(9);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Reddit.png" width="16px" 
align="absmiddle" border="0" height="16px"> Reddit</a> </div><div><a 
class="AddTo" title="Add this page to Newsvine" onclick="return 
socialLinks.addto(10);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_Newsvine.png" width="16px" 
align="absmiddle" border="0" height="16px"> Newsvine</a> </div><div><a 
class="AddTo" title="Add this page to Stumbleupon" onclick="return 
socialLinks.addto(11);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_stumbleupon.png" width="16px" 
align="absmiddle" border="0" height="16px"> Stumbleupon</a> </div><div><a
 class="AddTo" title="Add this page to Mr. Wong" onclick="return 
socialLinks.addto(12);" href="#"><img 
src="ExcelFormat.aspx_files/AddTo_MrWong.png" width="16px" 
align="absmiddle" border="0" height="16px"> Mr. Wong</a> </div><div><a 
class="AddTo" title="Send as Email" onclick="return 
socialLinks.addto(13);" href="#"><img 
src="ExcelFormat.aspx_files/envelope.gif" width="16px" align="absmiddle"
 border="0" height="16px"> Send as Email</a> </div></div>
 &nbsp;
 &nbsp;

<img id="ctl00_ArticleHeaderLinks_ArticleBmk_Img" 
src="ExcelFormat.aspx_files/link.png" alt="Bookmark" style="height: 
16px; width: 16px; border-width: 0px; vertical-align: middle;">
<a id="ctl00_ArticleHeaderLinks_ArticleBmk_Lnk" name="bm_42504_2" 
class="" onclick="return bookmarkMe(42504, 2, 
'/script/Bookmarks/Ajax/Add.aspx?obid=42504&amp;obtid=2&amp;action=AddBookmark');"
 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=42504&amp;obtid=2&amp;action=AddBookmark">Bookmark</a>
<span id="ctl00_ArticleHeaderLinks_ArticleBmk_StatusMsg" 
class="tiny-text" style="display: none;" name="bm_42504_2"></span>

 &nbsp;
<img src="ExcelFormat.aspx_files/discuss.gif" alt="Discuss" 
style="vertical-align: middle;" width="15px" height="16px"> <a 
href="#_comments">Discuss</a> &nbsp; 

<img src="ExcelFormat.aspx_files/report.gif" alt="Broken Article?" 
style="vertical-align: middle;" width="16px" height="16px"><a 
id="ctl00_ArticleHeaderLinks_BrokenLnk" 
href="http://www.codeproject.com/script/Articles/Report.aspx?aid=42504">Report</a>
 &nbsp;
</div>
		</td>
		<td style="text-align: right; white-space: nowrap; width: 100px;">
		<table id="ctl00_CurRat" name="CurRat_42504">
	<tbody><tr>
		<td>
<table class="">
<tbody><tr>
	<td id="ctl00_ArticleRating_VL" style="white-space: nowrap;" 
class="small-text" align="right"> 
		<span id="ctl00_ArticleRating_VoteLabel">36 votes for this article.</span>
	</td>
		
	<td>
		<table border="1" cellpadding="0" cellspacing="0">
			<tbody><tr>
				<td width="20px" align="left" bgcolor="White" height="7px"><img 
src="ExcelFormat.aspx_files/red.gif" width="20" align="middle" 
border="0" height="7"></td>
				<td width="20px" align="left" bgcolor="White" height="7px"><img 
src="ExcelFormat.aspx_files/red.gif" width="20" align="middle" 
border="0" height="7"></td>
				<td width="20px" align="left" bgcolor="White" height="7px"><img 
src="ExcelFormat.aspx_files/red.gif" width="20" align="middle" 
border="0" height="7"></td>
				<td width="20px" align="left" bgcolor="White" height="7px"><img 
src="ExcelFormat.aspx_files/red.gif" width="20" align="middle" 
border="0" height="7"></td>
				<td style="white-space: nowrap; padding: 0px;" width="20px" 
align="left" bgcolor="White" height="7px"><img 
src="ExcelFormat.aspx_files/red.gif" width="17" align="middle" 
border="0" height="7"><img src="ExcelFormat.aspx_files/white.gif" 
width="3" align="middle" border="0" height="7"></td>
			</tr>
		</tbody></table>
		
		<span id="ctl00_ArticleRating_Votes" class="small-text"></span>
	</td>
</tr>
<tr id="ctl00_ArticleRating_PopularityRow">
			<td colspan="2" class="small-text" align="right">
		<a id="ctl00_ArticleRating_PopularityLnk" title="Calculated as rating x
 Log10(# votes)" 
href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity:
 7.53</a>
		<span id="ctl00_ArticleRating_PopularityLbl"></span>
		<span id="ratingVal">Rating: <b>4.84</b> out of 5</span>
		
	</td>
		</tr>
		
</tbody></table>
</td>
		<td>            
<div>
<table class="HistTable" title="Voting Distribution. Recent data only"><tbody><tr><td><img
 src="ExcelFormat.aspx_files/t.gif" alt="" title="" width="10px" 
border="0px" height="1px"><br><span title="0 votes">1</span></td>
<td><img src="ExcelFormat.aspx_files/t.gif" alt="" title="" width="10px"
 border="0px" height="1px"><br><span title="0 votes">2</span></td>
<td><img src="ExcelFormat.aspx_files/pollcol.gif" alt="2 votes, 5.6%" 
title="2 votes, 5.6%" width="10px" border="0px" height="1px"><br><span 
title="2 votes">3</span></td>
<td><img src="ExcelFormat.aspx_files/pollcol.gif" alt="2 votes, 5.6%" 
title="2 votes, 5.6%" width="10px" border="0px" height="1px"><br><span 
title="2 votes">4</span></td>
<td><img src="ExcelFormat.aspx_files/pollcol.gif" alt="32 votes, 88.9%" 
title="32 votes, 88.9%" width="10px" border="0px" height="20px"><br><span
 title="32 votes">5</span></td>
</tr></tbody></table>
</div>



</td>
	</tr>
</tbody></table>

		</td>
	</tr>
	</tbody></table>
	
	
	
	

	
	

	
	
	
	
	
	
	
	<div id="ctl00_confirmWarning" class="Callout small-text" 
style="padding: 10px; margin: 20px;"><img style="float: left; 
margin-right: 10px;" src="ExcelFormat.aspx_files/warning_32.png" 
width="32px" height="32px"><b>Is your email address OK?</b>
	You are signed up for our newsletters but your email address has not 
been reconfirmed in a 
	long time. To make this warning go away please click 
	<a id="ctl00_RequestConfirmLink" 
href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2foffice%2fExcelFormat.aspx">here</a>
 to have a 
	confirmation email sent so we can confirm your email address and 
continue sending you your 
	newsletters. Alternatively, you can 
	<a id="ctl00_SubscribeLink" 
href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2foffice%2fExcelFormat.aspx">update
 your subscriptions</a>.</div>
	
	
	
	
	<div id="contentdiv">
	
	<!-- Main Page Contents Start -->
	

<!-- Article Starts -->


<ul class="download">
<li><a 
href="http://www.codeproject.com/KB/office/ExcelFormat/ExcelFormat_bin.zip">Download
 demo project - 81.39 KB</a> </li>

<li><a 
href="http://www.codeproject.com/KB/office/ExcelFormat/ExcelFormat_src.zip">Download
 source -&nbsp;52.53 KB</a> </li>
</ul>
<img alt="ExcelFormat" src="ExcelFormat.aspx_files/example1.png" 
complete="true" width="514" height="275"> 
<h2>Introduction</h2>

<p>There has been the C++ project <a 
href="http://www.codeproject.com/KB/office/BasicExcel.aspx">BasicExcel</a>
 for quite some years now. It is very useful to read and write Excel 
sheets in <em>.xls</em> format. However, it contains only very basic 
functionality. There are missing features like text formatting using 
fonts, and display formats and formulas are not yet supported. This 
article covers this additional functionality. The new, derived project <code>ExcelFormat</code>
 is based on the old <code>BasicExcel </code>code, and just adds what I 
was missing for my own needs. If you want to see where I am using the 
new library, you can look at the Export functions of <a 
href="http://www.foxplanet.de/servicemgr">Service Manager</a> and <a 
href="http://www.foxplanet.de/uninstmgr">Uninstall Manager</a>.</p>

<h2>XLS Format</h2>

<p>This library processes Excel files in the <em>BIFF8</em> XLS file 
format. For a detailed documentation of the format and all its 
internals, there are two documents available:</p>

<ul>
<li>OpenOffice provides <a 
href="http://sc.openoffice.org/excelfileformat.pdf">OpenOffice.org's 
Documentation of the Microsoft Excel File Format</a>.</li>

<li>Microsoft published the <a 
href="http://www.microsoft.com/interop/docs/OfficeBinaryFormats.mspx">Microsoft
 Office Binary File Formats</a> a few years later.</li>
</ul>

<h2>Using the Code</h2>

<p>To use the new formatting functionality, first create an <code>XLSFormatManager</code>
 object, like in the <code>example1()</code> function, and attach it to 
an existing <code>BasicExcel</code> object:</p>

<div class="small-text" id="premain0" style="width: 100%; cursor: 
pointer;"><img preid="0" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg0" width="9" height="9"><span preid="0" style="margin-bottom: 
0pt;" id="precollapse0"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre0" lang="C++"><span class="code-keyword">void</span> example1(<span class="code-keyword">const</span> <span class="code-keyword">char</span>* path)
{
    BasicExcel xls;
 
    <span class="code-comment">//</span><span class="code-comment"> create sheet 1 and get the associated BasicExcelWorksheet pointer
</span>    xls.New(<span class="code-digit">1</span>);
    BasicExcelWorksheet* sheet = xls.GetWorksheet((size_t)<span class="code-digit">0</span>);
 
    XLSFormatManager fmt_mgr(xls);</pre>

<p>You can find all the examples of this article in the source code file
 <em>Examples.cpp</em>.</p>

<p>To define a custom font, create an <code>ExcelFont</code> object and 
set any needed properties, for example, the font weight for a bold font:</p>

<div class="small-text" id="premain1" style="width: 100%; cursor: 
pointer;"><img preid="1" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg1" width="9" height="9"><span preid="1" style="margin-bottom: 
0pt;" id="precollapse1"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre1" lang="C++">ExcelFont font_bold;
font_bold._weight = FW_BOLD;	<span class="code-comment">//</span><span class="code-comment"> 700=bold, 400=normal</span></pre>

<p>The format of an Excel cell can be defined by a <code>CellFormat</code>
 object, which holds the chosen font and some more properties:</p>

<div class="small-text" id="premain2" style="width: 100%; cursor: 
pointer;"><img preid="2" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg2" width="9" height="9"><span preid="2" style="margin-bottom: 
0pt;" id="precollapse2"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre2" lang="C++">CellFormat fmt_bold(fmt_mgr);
fmt_bold.set_font(font_bold);</pre>

<p>After you have prepared the <code>CellFormat</code>, you can choose 
the font and display settings of Excel cells by calling <code>SetFormat()</code>:</p>

<div class="small-text" id="premain3" style="width: 100%; cursor: 
pointer;"><img preid="3" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg3" width="9" height="9"><span preid="3" style="margin-bottom: 
0pt;" id="precollapse3"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre3" lang="C++"><span class="code-comment">//</span><span class="code-comment"> Create a table containing a header row in bold and four rows below.
</span>size_t col, row = <span class="code-digit">0</span>;
 
<span class="code-keyword">for</span>(col=0; col<span class="code-keyword">&lt;</span><span class="code-digit">10</span>; ++col) {
    BasicExcelCell* cell = sheet-<span class="code-keyword">&gt;</span>Cell(row, col);
 
    cell-<span class="code-keyword">&gt;</span>Set(<span class="code-string">"</span><span class="code-string">TITLE"</span>);
    cell-<span class="code-keyword">&gt;</span>SetFormat(fmt_bold);
}
 
<span class="code-keyword">while</span>(++row <span class="code-keyword">&lt;</span> <span class="code-digit">4</span>) {
    <span class="code-keyword">for</span>(size_t col=0; col<span class="code-keyword">&lt;</span><span class="code-digit">10</span>; ++col)
        sheet-<span class="code-keyword">&gt;</span>Cell(row, col)-<span class="code-keyword">&gt;</span>Set(<span class="code-string">"</span><span class="code-string">text"</span>);
}
 
++row;</pre>

<p>Text color is specified by setting color indices in <code>ExcelFont</code>,
 for example:</p>

<div class="small-text" id="premain4" style="width: 100%; cursor: 
pointer;"><img preid="4" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg4" width="9" height="9"><span preid="4" style="margin-bottom: 
0pt;" id="precollapse4"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre4" lang="C++">ExcelFont font_red_bold;
font_red_bold._weight = FW_BOLD;
font_red_bold._color_index = EGA_RED;
 
CellFormat fmt_red_bold(fmt_mgr, font_red_bold);
fmt_red_bold.set_color1(COLOR1_PAT_SOLID); 		<span class="code-comment">//</span><span class="code-comment"> solid background
</span>fmt_red_bold.set_color2(MAKE_COLOR2(EGA_BLUE,<span class="code-digit">0</span>));	<span class="code-comment">//</span><span class="code-comment"> blue background
</span> 
CellFormat fmt_green(fmt_mgr, ExcelFont().set_color_index(EGA_GREEN));
 
<span class="code-keyword">for</span>(col=0; col<span class="code-keyword">&lt;</span><span class="code-digit">10</span>; ++col) {
    BasicExcelCell* cell = sheet-<span class="code-keyword">&gt;</span>Cell(row, col);
 
    cell-<span class="code-keyword">&gt;</span>Set(<span class="code-string">"</span><span class="code-string">xxx"</span>);
    cell-<span class="code-keyword">&gt;</span>SetFormat(fmt_red_bold);
 
    cell = sheet-<span class="code-keyword">&gt;</span>Cell(row, ++col);
    cell-<span class="code-keyword">&gt;</span>Set(<span class="code-string">"</span><span class="code-string">yyy"</span>);
    cell-<span class="code-keyword">&gt;</span>SetFormat(fmt_green);
}</pre>

<p><em>ExcelFormat.h</em> contains constants to define basic palette 
colors in the enumeration <code>EXCEL_COLORS</code>, you can use in 
calls to <code>ExcelFont()::set_color_index()</code>. The macro <code>MAKE_COLOR2</code>
 accepts two color indices to specify the pattern line and pattern 
background colors. As a shortcut to calling <code>CellFormat::set_color1()</code>
 and <code>CellFormat::set_color2()</code>, you can also use <code>CellFormat::set_background()</code>
 to define cells with solid background colors or colorize patterns.</p>

<p>After creating and formatting the Excel cells in memory, all you have
 to do is to save the new Excel sheet as a file:</p>

<div class="small-text" id="premain5" style="width: 100%; cursor: 
pointer;"><img preid="5" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg5" width="9" height="9"><span preid="5" style="margin-bottom: 
0pt;" id="precollapse5"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre5" lang="C++">    xls.SaveAs(path);
}</pre>

<p>This should be enough for a quick overview on how to use the new <code>ExcelFormat</code>
 objects. In the source code file <em>ExcelFormat.cpp</em>, you can find
 some more examples.</p>

<h3>ExcelFont</h3>

<p>There are nine font properties available:</p>

<div class="small-text" id="premain6" style="width: 100%; cursor: 
pointer;"><img preid="6" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg6" width="9" height="9"><span preid="6" style="margin-bottom: 
0pt;" id="precollapse6"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre6" lang="C++"><span class="code-keyword">struct</span> ExcelFont
{
    ExcelFont()
 
    ...
 
    wstring _name;
    <span class="code-keyword">short</span>   _height;
    <span class="code-keyword">short</span>   _weight;
    <span class="code-keyword">short</span>   _options;
    <span class="code-keyword">short</span>   _color_index;
    <span class="code-keyword">short</span>   _escapement_type;
    <span class="code-keyword">char</span>    _underline_type;
    <span class="code-keyword">char</span>    _family;
    <span class="code-keyword">char</span>    _character_set;
 
    ...
 
};</pre>

<p>For detailed information, please look into the <a 
href="http://sc.openoffice.org/excelfileformat.pdf">XLS file format 
documentation</a>.</p>

<h3>CellFormat</h3>

<p>These <code>CellFormat</code> properties are available in addition to
 the chosen <code>ExcelFont</code> and the display format:</p>

<div class="small-text" id="premain7" style="width: 100%; cursor: 
pointer;"><img preid="7" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg7" width="9" height="9"><span preid="7" style="margin-bottom: 
0pt;" id="precollapse7"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre7" lang="C++"><span class="code-keyword">struct</span> CellFormat
{
    CellFormat(XLSFormatManager&amp; mgr)
 
    ...
 
    <span class="code-keyword">char</span>    _alignment;
    <span class="code-keyword">char</span>    _rotation;
    <span class="code-keyword">char</span>    _text_props;
    <span class="code-keyword">int</span>     _borderlines;
    <span class="code-keyword">int</span>     _color1;
    <span class="code-keyword">short</span>   _color2;
 
    ...
 
};</pre>

<p>In <code>example2()</code>, you can see how to change the font face 
and the font size:</p>

<div class="small-text" id="premain8" style="width: 100%; cursor: 
pointer;"><img preid="8" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg8" width="9" height="9"><span preid="8" style="margin-bottom: 
0pt;" id="precollapse8"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre8" lang="C++">ExcelFont font_header;
font_header.set_weight(FW_BOLD);
font_header.set_underline_type(EXCEL_UNDERLINE_SINGLE);
font_header.set_font_name(L<span class="code-string">"</span><span class="code-string">Times New Roman"</span>);  <span class="code-comment">//</span><span class="code-comment"> font face "Times New Roman"
</span> 
font_header.set_color_index(EGA_BLUE);
font_header._options = EXCEL_FONT_STRUCK_OUT;
 
CellFormat fmt_header(fmt_mgr, font_header);
fmt_header.set_rotation(<span class="code-digit">30</span>); <span class="code-comment">//</span><span class="code-comment"> rotate the header cell text 30° to the left
</span> 
size_t row = <span class="code-digit">0</span>;
 
<span class="code-keyword">for</span>(size_t col=0; col<span class="code-keyword">&lt;</span><span class="code-digit">10</span>; ++col) {
    BasicExcelCell* cell = sheet-<span class="code-keyword">&gt;</span>Cell(row, col);
 
    cell-<span class="code-keyword">&gt;</span>Set(<span class="code-string">"</span><span class="code-string">TITLE"</span>);
    cell-<span class="code-keyword">&gt;</span>SetFormat(fmt_header);
}</pre>

<p>The <code>example3()</code> function shows how to use <code>CellFormat::set_format_string()</code>
 and <code>BasicExcelCell::SetFormat()</code> to define text, number, 
and date format strings. There are some predefined constants for format 
strings:</p>

<div class="small-text" id="premain9" style="width: 100%; cursor: 
pointer;"><img preid="9" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg9" width="9" height="9"><span preid="9" style="margin-bottom: 
0pt;" id="precollapse9"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre9" lang="C++"><span class="code-preprocessor">#define</span> XLS_FORMAT_GENERAL      L<span class="code-string">"</span><span class="code-string">General"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_TEXT         L<span class="code-string">"</span><span class="code-string">@"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_INTEGER      L<span class="code-string">"</span><span class="code-string">0"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_DECIMAL      L<span class="code-string">"</span><span class="code-string">0.00"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_PERCENT      L<span class="code-string">"</span><span class="code-string">0%"</span>
 
<span class="code-preprocessor">#define</span> XLS_FORMAT_DATE         L<span class="code-string">"</span><span class="code-string">M/D/YY"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_TIME         L<span class="code-string">"</span><span class="code-string">h:mm:ss"</span>
<span class="code-preprocessor">#define</span> XLS_FORMAT_DATETIME     L<span class="code-string">"</span><span class="code-string">M/D/YY h:mm"</span></pre>

<p>However, you can use any valid Excel format string to define custom 
display formats.</p>

<p><code>example4()</code> shows how to use many different fonts and 
colors in one sheet:</p>
<img alt="ExcelFormat" src="ExcelFormat.aspx_files/example4.png" 
complete="true" width="547" height="462"> 
<h3>Formulas</h3>

<p>Formulas are now preserved when reading and writing an Excel sheet. 
You can even store a formula into an Excel cell by calling <code>BasicExcelCell::SetFormula()</code>.
 However, currently, you either have to copy a <code>Worksheet::CellTable::RowBlock::CellBlock::Formula</code>
 object from an already existing cell, or you have to define it 
yourself, which is quite tricky because Excel uses a pre-parsed formula 
containing <em>RPN</em> tokens.</p>

<h2>Points of Interest</h2>

<p>For those who are interested in a bit of background information, I 
want to provide a description of what has been changed since the 
predecessor library <a 
href="http://www.codeproject.com/KB/office/BasicExcel.aspx">BasicExcel</a>.</p>

<h3>Conditional Compilation</h3>

<p>There are two different <code>BasicExcel </code>implementations, one 
for VC++ version 6.0, and one for newer compilers. <code>ExcelFormat </code>now
 merges these two code bases by using conditional compilation to handle 
the differences. Most of this is accomplished in the header file by this
 code snippet (and modifications using the newly defined macros):</p>

<div class="small-text" id="premain10" style="width: 100%; cursor: 
pointer;"><img preid="10" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg10" width="9" height="9"><span preid="10" 
style="margin-bottom: 0pt;" id="precollapse10"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre10" lang="C++"><span class="code-preprocessor">#if</span> _MSC_VER<span class="code-keyword">&lt;</span>=1200    <span class="code-comment">//</span><span class="code-comment"> VC++ 6.0
</span> 
<span class="code-preprocessor">#pragma</span> warning(disable: <span class="code-digit">4786</span>)
<span class="code-preprocessor">#define</span> LONGINT <span class="code-keyword">__int64</span>
<span class="code-preprocessor">#define</span> LONGINT_CONST(x) x
<span class="code-preprocessor">#define</span> COMPOUNDFILE
 
<span class="code-preprocessor">#else</span>    <span class="code-comment">//</span><span class="code-comment"> newer Microsoft compilers
</span> 
<span class="code-preprocessor">#define</span> LONGINT <span class="code-keyword">long</span> <span class="code-keyword">long</span>
<span class="code-preprocessor">#define</span> COMPOUNDFILE CompoundFile::
<span class="code-preprocessor">#define</span> LONGINT_CONST(x) x##LL
 
<span class="code-preprocessor">#endif</span></pre>

<p>The <code><span class="code-preprocessor">#pragma</span> warning</code>
 statement disables compiler warnings of VC++ 6.0 because of long 
compiler internal names in object files, which occur for non-trivial 
usage of STL classes.</p>

<p>Immediately after these defines, there are these preprocessor 
statements for VS 2005 and above:</p>

<div class="small-text" id="premain11" style="width: 100%; cursor: 
pointer;"><img preid="11" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg11" width="9" height="9"><span preid="11" 
style="margin-bottom: 0pt;" id="precollapse11"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre11" lang="C++"><span class="code-preprocessor">#if</span> _MSC_VER<span class="code-keyword">&gt;</span>=1400    		<span class="code-comment">//</span><span class="code-comment"> VS 2005
</span><span class="code-preprocessor">#define</span> _CRT_SECURE_NO_WARNINGS    	<span class="code-comment">//</span><span class="code-comment">MF
</span><span class="code-preprocessor">#define</span> _SCL_SECURE_NO_WARNINGS    	<span class="code-comment">//</span><span class="code-comment">MF
</span><span class="code-preprocessor">#endif</span></pre>

<p>They disable the VC++ security library warnings, because the <code>BasicExcel
 </code>code is not yet prepared for this new runtime library additions.
 By the way, the <em>MF</em> comments mark additions and fixes by me to 
the old <code>BasicExcel </code>code.</p>

<p>Additionally, I eliminated some compiler warnings by fixing data 
types. Typically, this was a change from integral types like <code><span
 class="code-keyword">int</span></code> to the C runtime library type <code>size_t</code>.</p>

<h3>New Features</h3>

<p>In addition to the new API described above, I had to add code in <code>BasicExcel
 </code>in order to implement these new features:</p>

<ul>
<li>Read and write the <code>Formula</code> structure from/to XLS files</li>

<li>Define, read, and write the <code>FORMAT</code> structure from/to 
XLS files</li>

<li>Get/set the XF index value <code>BasicExcelCell</code> objects for 
all the various cell types</li>
</ul>

<h3>Formatting Storage Structures</h3>

<p>The information about the format of an Excel cell in the <em>BIFF8</em>
 file format is stored using a so called <em>XF index</em>. This refers 
to an XF (<q>extended format</q>) record, which consists of the 
following members:</p>

<div class="small-text" id="premain12" style="width: 100%; cursor: 
pointer;"><img preid="12" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg12" width="9" height="9"><span preid="12" 
style="margin-bottom: 0pt;" id="precollapse12"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre12" lang="C++">XF {
    <span class="code-keyword">short</span>       fontRecordIndex     <span class="code-comment">//</span><span class="code-comment"> FORMAT index
</span>    <span class="code-keyword">short</span>       formatRecordIndex   <span class="code-comment">//</span><span class="code-comment"> FONT index
</span> 
    <span class="code-keyword">short</span>       protectionType
    <span class="code-keyword">char</span>        alignment
    <span class="code-keyword">char</span>        rotation
    <span class="code-keyword">char</span>        textProperties
    <span class="code-keyword">char</span>        usedAttributes
    <span class="code-keyword">int</span>         borderLines
    <span class="code-keyword">int</span>         colour1
    <span class="code-keyword">short</span>       colour2
}</pre>

<p>Besides a few directly associated attributes specifying alignment, 
rotation, etc. of the Excel cell, there are two more index values: <code>fontRecordIndex</code>
 and <code>formatRecordIndex</code>. These are used to define font and 
display format descriptions. In the whole picture, this two-level index 
based formatting architecture enables cell formatting with small file 
sizes and low memory usage, because there are typically only a few 
different fonts and display formats used in an Excel worksheet. The font
 index refers to a <code>FONT</code> record with the following 
attributes:</p>

<div class="small-text" id="premain13" style="width: 100%; cursor: 
pointer;"><img preid="13" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg13" width="9" height="9"><span preid="13" 
style="margin-bottom: 0pt;" id="precollapse13"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre13" lang="C++">FONT {
    <span class="code-keyword">short</span>       height
    <span class="code-keyword">short</span>       options
    <span class="code-keyword">short</span>       colourIndex
    <span class="code-keyword">short</span>       weight
    <span class="code-keyword">short</span>       escapementType
    <span class="code-keyword">char</span>        underlineType
    <span class="code-keyword">char</span>        family
    <span class="code-keyword">char</span>        characterSet
    <span class="code-keyword">char</span>        unused
    SmallString name
}</pre>

<p>The third index is a special one. This format index is associated 
with a record containing only the index itself and a text representation
 of the display format:</p>

<div class="small-text" id="premain14" style="width: 100%; cursor: 
pointer;"><img preid="14" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg14" width="9" height="9"><span preid="14" 
style="margin-bottom: 0pt;" id="precollapse14"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre14" lang="C++">FORMAT {
    <span class="code-keyword">short</span>       index
    LargeString fmtstring
}</pre>

<p><code>XLSFormatManager</code> manages these three formatting 
substructures to format Excel cells using the C++ structures <code>CellFormat</code>
 and <code>ExcelFont</code>:</p>

<div class="small-text" id="premain15" style="width: 100%; cursor: 
pointer;"><img preid="15" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg15" width="9" height="9"><span preid="15" 
style="margin-bottom: 0pt;" id="precollapse15"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre15" lang="text">struct CellFormat  -&gt;  XF {FORMAT index, FONT index, XF attributes}
 
struct ExcelFont   -&gt;  FONT {FONT attributes}</pre>

<p>On calling <code>CellFormat::set_font(<span class="code-keyword">const</span>
 ExcelFont&amp; font)</code>, the manager class searches for an already 
registered matching font description. If there is none yet, a new <code>FONT</code>
 record is created to be stored in the Excel sheet. On calling <code>CellFormat::set_format_string(<span
 class="code-keyword">const</span> wstring&amp; fmt_str)</code>, the 
manager class searches for an already registered matching display format
 string. If there is none yet, a new <code>FORMAT</code> record stores 
the display format string. The same strategy is used when applying a <code>CellFormat</code>
 to a cell object by calling <code>BasicExcelCell::SetFormat(<span 
class="code-keyword">const</span> CellFormat&amp; fmt)</code>: the 
manager class searches for an already registered matching XF description
 with identical font and format indices as well as matching XF 
attributes. If there is none yet, a new <code>XF</code> record is 
created to be stored in the Excel sheet. In the end, this results in a 
list of <code>FORMAT</code>, <code>FONT</code>, and <code>XF</code> 
records, which are stored in the header of the Excel workbook file. Each
 cell is formatted by storing a single related XF index, which 
determines all the cell formatting attributes, the font, and the display
 format.</p>

<p>For further implementation details, please have a look into <em>ExcelFormat.h</em>,
 <em>ExcelFormat.cpp</em>, <em>BasicExcel.hpp</em> and <em>BasicExcel.cpp</em>
 of the source code.</p>

<h3>Memory Usage</h3>

<p>To limit memory usage, a reference counting <code>SmartPtr</code> is 
used to manage the heap structures needed for formula storage. Every 
cell contains only an optionally filled pointer to the <code><span 
class="code-keyword">struct</span> Formula</code>. For text or number 
cells, formula information is not needed. So the smart pointer stays 
empty, and just contains the value <code>NULL</code>.</p>

<p>In the following section, you can see the implementation of the <code><span
 class="code-keyword">struct</span> RefCnt</code> as the base for <code><span
 class="code-keyword">struct</span> Formula</code> and the template <code><span
 class="code-keyword">struct</span> SmartPtr</code> to hold the 
reference counted heap objects:</p>

<div class="small-text" id="premain16" style="width: 100%; cursor: 
pointer;"><img preid="16" src="ExcelFormat.aspx_files/minus.gif" 
id="preimg16" width="9" height="9"><span preid="16" 
style="margin-bottom: 0pt;" id="precollapse16"> Collapse</span></div><pre style="margin-top: 0pt;" id="pre16" lang="C++"><span class="code-comment">//</span><span class="code-comment"> reference counter for SmartPtr managed objects
</span><span class="code-keyword">struct</span> RefCnt
{
    <span class="code-comment">//</span><span class="code-comment"> On construction the reference counter
</span>    <span class="code-comment">//</span><span class="code-comment"> is initialized with an usage count of 0.
</span>    RefCnt()
     :    _ref_cnt(<span class="code-digit">0</span>)
    {
    }
 
    <span class="code-keyword">int</span>    _ref_cnt;
};
 
<span class="code-comment">//</span><span class="code-comment"> reference counting smart pointer
</span><span class="code-keyword">template</span><span class="code-keyword">&lt;</span><span class="code-keyword">typename</span> T<span class="code-keyword">&gt;</span> <span class="code-keyword">struct</span> SmartPtr
{
	<span class="code-comment">//</span><span class="code-comment"> default constructor
</span>	SmartPtr()
	 :	_ptr(NULL)
	{
	}
 
	<span class="code-comment">//</span><span class="code-comment"> The initialized SmartPtr constructor increments the reference counter
</span>          <span class="code-comment">//</span><span class="code-comment"> in struct RefCnt.
</span>	SmartPtr(T* p)
	 :	_ptr(p)
	{
		<span class="code-keyword">if</span> (p)
			++_ptr-<span class="code-keyword">&gt;</span>_ref_cnt;
	}
 
    <span class="code-comment">//</span><span class="code-comment"> The copy constructor increments the reference counter.
</span>    SmartPtr(<span class="code-keyword">const</span> SmartPtr&amp; other)
     :    _ptr(other._ptr)
    {
        <span class="code-keyword">if</span> (_ptr)
            ++_ptr-<span class="code-keyword">&gt;</span>_ref_cnt;
    }
 
    <span class="code-comment">//</span><span class="code-comment"> The destructor decreases the reference counter and
</span>    <span class="code-comment">//</span><span class="code-comment"> frees the managed memory as the counter reaches zero.
</span>    ~SmartPtr()
    {
        <span class="code-keyword">if</span> (_ptr) {
            <span class="code-keyword">if</span> (!--_ptr-<span class="code-keyword">&gt;</span>_ref_cnt)
                <span class="code-keyword">delete</span> _ptr;
        }
    }
 
    <span class="code-comment">//</span><span class="code-comment"> The assignment operator increments the reference counter.
</span>    SmartPtr&amp; operator=(T* p)
    {
        <span class="code-keyword">if</span> (_ptr) {
            <span class="code-keyword">if</span> (!--_ptr-<span class="code-keyword">&gt;</span>_ref_cnt)
                <span class="code-keyword">delete</span> _ptr;
 
            _ptr = NULL;
        }
 
        <span class="code-keyword">if</span> (p) {
            _ptr = p;
 
            ++_ptr-<span class="code-keyword">&gt;</span>_ref_cnt;
        }
 
        <span class="code-keyword">return</span> *<span class="code-keyword">this</span>;
    }
 
     <span class="code-comment">//</span><span class="code-comment"> operator bool() to check for non-empty smart pointers
</span>    <span class="code-keyword">operator</span> <span class="code-keyword">bool</span>() <span class="code-keyword">const</span> {<span class="code-keyword">return</span> _ptr != NULL;}
 
     <span class="code-comment">//</span><span class="code-comment"> operator!() to check for empty smart pointers
</span>    <span class="code-keyword">bool</span> operator!() <span class="code-keyword">const</span> {<span class="code-keyword">return</span> !_ptr;}
 
     <span class="code-comment">//</span><span class="code-comment"> operator-&gt;() to access the managed objects
</span>    T* <span class="code-keyword">operator</span>-<span class="code-keyword">&gt;</span>() {<span class="code-keyword">return</span> _ptr;}
    <span class="code-keyword">const</span> T* <span class="code-keyword">operator</span>-<span class="code-keyword">&gt;</span>() <span class="code-keyword">const</span> {<span class="code-keyword">return</span> _ptr;}
 
	 <span class="code-comment">//</span><span class="code-comment"> Derefence pointed memory
</span>	T&amp; <span class="code-keyword">operator</span>*() {<span class="code-keyword">return</span> *_ptr;}
	<span class="code-keyword">const</span> T&amp; <span class="code-keyword">operator</span>*() <span class="code-keyword">const</span> {<span class="code-keyword">return</span> *_ptr;}
 
<span class="code-keyword">private</span>:
    T* _ptr;
};</pre>

<h3>String Conversion</h3>

<p>There are some new string conversion functions: <code>stringFromSmallString()</code>,
 <code>stringFromLargeString()</code>, <code>wstringFromSmallString()</code>,
 <code>wstringFromLargeString()</code> using <code>narrow_string()</code>/<code>widen_string()</code>
 are used to convert from internal Excel string structures to STL string
 classes and vice versa. You can use them to access the internal data 
storage of <code>BasicExcel</code>.</p>

<h2>History</h2>

<ul>
<li>
<p>20.09.2009 - Version 1.0 of <code>ExcelFormat </code>(<code>BasicExcel
 </code>Version 2.0) </p>
</li>

<li>
<p>28.09.2009 - Version 2.0:<br>&nbsp;Added new section <em>Formatting 
storage structures</em> </p>
</li>

<li>
<p>04.10.2009 - Version 2.1:<br>&nbsp;Updated source code with macros 
and constants for cell and font properties </p>
</li>

<li>
<p>07.11.2009 - Version 2.2:<br>&nbsp;fixed VS2008 problem when reading 
sheets with formula fields<br>&nbsp;added BasicExcel::Close(), 
CellFormat::get/set_text_props() and get/set_borderlines() </p>
</li>

<li>12.01.2010 - Version 2.3: &nbsp;(by Ami Castonguay and Martin Fuchs)<br>&nbsp;fixed
 reference counting of Formula data structs<br>&nbsp;support for shared 
formulas<br>&nbsp;support for merged cells<br>&nbsp;save formatting even
 if cell is empty<br>&nbsp;flush fstream instead of closing it followed 
by open to prevent races in conjunction with virus scanners<br>&nbsp;enable
 reading of XLS files exported by MacOS Numbers.app<br>
<p>

</p></li></ul>






	<!-- Main Page Contents End -->
	
	</div>
	
	
	<form name="aspnetForm" method="post" action="ExcelFormat.aspx" 
id="aspnetForm" style="margin: 0pt; padding: 0pt;">
<div>
<input name="__VIEWSTATE" id="__VIEWSTATE" 
value="/wEPDwUKMTAyMTMzODg1Ng9kFgJmD2QWBAIJD2QWBAIFDw8WAh4HVmlzaWJsZWdkZAINDw8WAh8AZ2RkAgoPZBYKAgcPZBYOAgEPZBYCZg8WAh4LXyFJdGVtQ291bnRmZAIDD2QWCGYPDxYCHgtOYXZpZ2F0ZVVybAUpL0tCL29mZmljZS9FeGNlbEZvcm1hdC5hc3B4P2Rpc3BsYXk9UHJpbnRkZAICDw8WAh8AaGRkAgMPZBYGAgIPDxYCHghJbWFnZVVybAUhL3NjcmlwdC9Cb29rbWFya3MvSW1hZ2VzL2xpbmsucG5nZGQCBA8PFgIfAgVAL3NjcmlwdC9Cb29rbWFya3MvQWRkLmFzcHg/b2JpZD00MjUwNCZvYnRpZD0yJmFjdGlvbj1BZGRCb29rbWFyaxYGHgRuYW1lBQpibV80MjUwNF8yHgVjbGFzc2UeB29uY2xpY2sFZXJldHVybiBib29rbWFya01lKDQyNTA0LCAyLCAnL3NjcmlwdC9Cb29rbWFya3MvQWpheC9BZGQuYXNweD9vYmlkPTQyNTA0Jm9idGlkPTImYWN0aW9uPUFkZEJvb2ttYXJrJyk7ZAIGDxYCHwQFCmJtXzQyNTA0XzJkAgQPDxYCHwIFJi9zY3JpcHQvQXJ0aWNsZXMvUmVwb3J0LmFzcHg/YWlkPTQyNTA0ZGQCBQ8WAh8EBQxDdXJSYXRfNDI1MDQWAmYPZBYCZg9kFgJmD2QWBGYPZBYCAgEPDxYCHgRUZXh0BRozNiB2b3RlcyBmb3IgdGhpcyBhcnRpY2xlLmRkAgMPZBYCZg9kFgQCAQ8PFgQfBwUQUG9wdWxhcml0eTogNy41Mx8CBSkvc2NyaXB0L0FydGljbGVzL1RvcEFydGljbGVzLmFzcHg/dGFfc289MWRkAgUPFgIfBwUcUmF0aW5nOiA8Yj40Ljg0PC9iPiBvdXQgb2YgNWQCEw8WAh8AZxYEAgEPDxYCHwIFTy9zY3JpcHQvTWVtYmVyc2hpcC9TZW5kQ29uZmlybVJlcXVlc3QuYXNweD9ycD0lMmZLQiUyZm9mZmljZSUyZkV4Y2VsRm9ybWF0LmFzcHhkZAIDDw8WAh8CBUYvc2NyaXB0L01lbWJlcnNoaXAvU3Vic2NyaWJlLmFzcHg/cnA9JTJmS0IlMmZvZmZpY2UlMmZFeGNlbEZvcm1hdC5hc3B4ZGQCGQ9kFgoCAQ9kFgQCAQ8WAh4JaW5uZXJodG1sBbYBPHA+VGhpcyBhcnRpY2xlLCBhbG9uZyB3aXRoIGFueSBhc3NvY2lhdGVkIHNvdXJjZSBjb2RlIGFuZCBmaWxlcywgaXMgbGljZW5zZWQgdW5kZXIgPGEgaHJlZj0iaHR0cDovL3d3dy5jb2RlcHJvamVjdC5jb20vaW5mby9jcG9sMTAuYXNweCI+VGhlIENvZGUgUHJvamVjdCBPcGVuIExpY2Vuc2UgKENQT0wpPC9hPjwvcD5kAgIPZBYCAgEPEGRkFgBkAgUPFgIfAQIBZAIHDxYCHwcF7gc8aDI+T3RoZXIgcG9wdWxhciBPZmZpY2UgRGV2ZWxvcG1lbnQgYXJ0aWNsZXM6PC9oMj48dWw+PGxpPjxhIGhyZWY9Ii9LQi9vZmZpY2UvR2VuZXJhdGluZ19Xb3JkX1JlcG9ydHMuYXNweCI+R2VuZXJhdGluZyBXb3JkIFJlcG9ydHMgLyBEb2N1bWVudHM8L2E+PGRpdiBjbGFzcz0ic21hbGwtdGV4dCI+R2VuZXJhdGUgV29yZCBkb2N1bWVudHMgYnkgYXBwbGluZyBYU0xUIG9uIFhNTCBkYXRhLjwvZGl2PjwvbGk+PGxpPjxhIGhyZWY9Ii9LQi9vZmZpY2UvQmFzaWNFeGNlbC5hc3B4Ij5CYXNpY0V4Y2VsIC0gQSBDbGFzcyB0byBSZWFkIGFuZCBXcml0ZSB0byBNaWNyb3NvZnQgRXhjZWw8L2E+PGRpdiBjbGFzcz0ic21hbGwtdGV4dCI+QSBDbGFzcyB0byBSZWFkIGFuZCBXcml0ZSB0byBNaWNyb3NvZnQgRXhjZWw8L2Rpdj48L2xpPjxsaT48YSBocmVmPSIvS0Ivb2ZmaWNlL091dGxvb2tfTmF2aWdhdGlvbl9QYW5lLmFzcHgiPk91dGxvb2sgMjAwMyBTdHlsZSBOYXZpZ2F0aW9uIFBhbmU8L2E+PGRpdiBjbGFzcz0ic21hbGwtdGV4dCI+T3V0bG9vayAyMDAzIFN0eWxlIE5hdmlnYXRpb24gUGFuZSAoQWxtb3N0IDIwMDcgU3R5bGUpPC9kaXY+PC9saT48bGk+PGEgaHJlZj0iL0tCL29mZmljZS9FeGNlbF9EYXRhUmVhZGVyLmFzcHgiPkZhc3QgRXhjZWwgZmlsZSByZWFkZXIgd2l0aCBiYXNpYyBmdW5jdGlvbmFsaXR5PC9hPjxkaXYgY2xhc3M9InNtYWxsLXRleHQiPkEgc2V0IG9mIG1hbmFnZWQgY2xhc3NlcyBmb3IgbmF0aXZlIHJlYWRpbmcgb2YgZGF0YSBmcm9tIE1TIEV4Y2VsIGZpbGVzPC9kaXY+PC9saT48bGk+PGEgaHJlZj0iL0tCL29mZmljZS9kZXNrdG9wc2VhcmNoMS5hc3B4Ij5EZXNrdG9wIFNlYXJjaCBBcHBsaWNhdGlvbjogUGFydCAxPC9hPjxkaXYgY2xhc3M9InNtYWxsLXRleHQiPkJ1aWxkaW5nIGFuIGFwcGxpY2F0aW9uIHRoYXQgc2VhcmNoZXMgeW91ciBPZmZpY2UgZG9jdW1lbnRzIGluIHRlbnRocyBvZiBhIHNlY29uZC48L2Rpdj48L2xpPjwvdWw+ZAILDw8WAh8AZ2RkAg0PZBYCZg9kFgICAQ9kFgJmD2QWAmYPFgQfBAUOUmF0ZUl0ZW1fNDI1MDQfBWUWAgIGD2QWAgIBDw9kFgIfBgUjcmV0dXJuIHJhdGVJdGVtKDQyNTA0LDIsdHJ1ZSx0cnVlKTtkAhsPDxYCHwBnZGQCIQ8WAh8AaGQCCw8PFgIfAgUnL3NjcmlwdC9BcnRpY2xlcy9BcnRpY2xlLmFzcHg/YWlkPTQyNTA0ZGQCEQ8WAh8HBQsxMiBKYW4gMjAxMGQCEw8PFgQfBwUNU2VhbiBFd2luZ3Rvbh8CBSgvc2NyaXB0L01lbWJlcnNoaXAvVmlldy5hc3B4P21pZD0zODczODcxZGQCFQ8WAh8HBR5Db3B5cmlnaHQgMjAwOSBieSBNYXJ0aW4gRnVjaHNkZLt2KRXp8djO2LYX1uwpwXzqU9HP"
 type="hidden">
</div>

<div>

	<input name="__EVENTVALIDATION" id="__EVENTVALIDATION" 
value="/wEWCAK38ur7DwLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC+WnOU3fWRPiCJFxUfRHe/yNdRsD"
 type="hidden">
</div>

	
	<h2>License</h2>
	<div id="ctl00_LicenseTerms"><p>This article, along with any associated
 source code and files, is licensed under <a 
href="http://www.codeproject.com/info/cpol10.aspx">The Code Project Open
 License (CPOL)</a></p></div>
	
	<h2>About the Author</h2>
	
			
   
        
<table width="100%" border="0" cellpadding="0" cellspacing="5">
<tbody><tr valign="top">
<td id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable" 
style="width: 155px;" valign="top">
	<b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" 
href="http://www.codeproject.com/Members/Martin-Fuchs">Martin Fuchs</a></b><br><br>
	<center></center><br>
	<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType" 
class="small-text">Member</span>		
</td>

<td>
	<br>	

	<table>
	<tbody><tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow">
	<td class="small-text" nowrap="nowrap">Occupation: </td>
	<td width="100%"><span 
id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle" 
class="small-text">Software Developer (Senior)</span></td>
</tr>


	

	<tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow">
	<td class="small-text">Location: </td>
	<td width="100%"><span 
id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation" 
class="small-text"><img src="ExcelFormat.aspx_files/DE.gif" 
alt="Germany" width="16px" height="11px"> Germany</span></td>
</tr>

	</tbody></table>
	</td>
	</tr>
	</tbody></table>


			<br>
		
	
	<table width="100%" border="0" cellpadding="0" cellspacing="0">	
	<tbody><tr valign="top">			
		<td style="width: 100%;">
			<h2>Other popular Office Development articles:</h2><ul><li><a 
href="http://www.codeproject.com/KB/office/Generating_Word_Reports.aspx">Generating
 Word Reports / Documents</a><div class="small-text">Generate Word 
documents by appling XSLT on XML data.</div></li><li><a 
href="http://www.codeproject.com/KB/office/BasicExcel.aspx">BasicExcel -
 A Class to Read and Write to Microsoft Excel</a><div class="small-text">A
 Class to Read and Write to Microsoft Excel</div></li><li><a 
href="http://www.codeproject.com/KB/office/Outlook_Navigation_Pane.aspx">Outlook
 2003 Style Navigation Pane</a><div class="small-text">Outlook 2003 
Style Navigation Pane (Almost 2007 Style)</div></li><li><a 
href="http://www.codeproject.com/KB/office/Excel_DataReader.aspx">Fast 
Excel file reader with basic functionality</a><div class="small-text">A 
set of managed classes for native reading of data from MS Excel files</div></li><li><a
 href="http://www.codeproject.com/KB/office/desktopsearch1.aspx">Desktop
 Search Application: Part 1</a><div class="small-text">Building an 
application that searches your Office documents in tenths of a second.</div></li></ul>
			
		</td>
		<td>
			<div id="ctl00_AdWords" style="display: inline-block; width: 300px; 
height: 250px;" title=""><iframe 
src="ExcelFormat.aspx_files/ServeHtml.htm" width="300px" frameborder="0"
 height="250px" scrolling="no"></iframe></div>						 
		</td>
	</tr>
	</tbody></table>

	<table id="ctl00_RateArticleRow" class="RatingBar" width="100%" 
border="0" cellpadding="0" cellspacing="0">
	<tbody><tr>
		<td><a href="#_top">Article Top</a></td>
		<td align="right"><div id="ctl00_RateArticle_RateItemWrapper" style=""
 name="RateItem_42504" class="">

<table width="100%" cellpadding="0" cellspacing="0">
<tbody><tr>
	<td id="ctl00_RateArticle_VoteResultDiv" width="100%" align="right" 
nowrap="nowrap">
		<span class="voteRes"></span>
		<img class="loaderImg" alt="loading..." 
src="ExcelFormat.aspx_files/ajax-loader.gif" style="display: none;" 
width="16px" height="16px"> 
	</td>
		
	
	<td class="voteTbl" style="white-space: nowrap;" align="right">
		<table class="">
		<tbody><tr valign="middle">
			
			<td id="ctl00_RateArticle_RateText" style="padding-right: 5px; 
white-space: nowrap;">
				<i><b>Rate this article for us!</b></i>
			</td>
		
			<td id="ctl00_RateArticle_StartForm" align="right" nowrap="nowrap">
				<i>&nbsp;&nbsp;Poor</i>
			</td>
		
			<td id="ctl00_RateArticle_VoteFormDiv" style="white-space: nowrap;" 
align="left">
				<table id="ctl00_RateArticle_VoteRBL" border="0">
			<tbody><tr>
				<td><input id="ctl00_RateArticle_VoteRBL_0" 
name="ctl00$RateArticle$VoteRBL" value="1" 
onclick="ChkRtctl00_RateArticle(1, 42504);" type="radio"></td><td><input
 id="ctl00_RateArticle_VoteRBL_1" name="ctl00$RateArticle$VoteRBL" 
value="2" onclick="ChkRtctl00_RateArticle(2, 42504);" type="radio"></td><td><input
 id="ctl00_RateArticle_VoteRBL_2" name="ctl00$RateArticle$VoteRBL" 
value="3" onclick="ChkRtctl00_RateArticle(3, 42504);" type="radio"></td><td><input
 id="ctl00_RateArticle_VoteRBL_3" name="ctl00$RateArticle$VoteRBL" 
value="4" onclick="ChkRtctl00_RateArticle(4, 42504);" type="radio"></td><td><input
 id="ctl00_RateArticle_VoteRBL_4" name="ctl00$RateArticle$VoteRBL" 
value="5" onclick="ChkRtctl00_RateArticle(5, 42504);" type="radio"></td>
			</tr>
		</tbody></table> 
			</td>
		
			<td id="ctl00_RateArticle_EndForm" align="left">
				<i>Excellent</i>
			</td>
		
			<td id="ctl00_RateArticle_VoteBtn">	
				<input name="ctl00$RateArticle$SubmitRateBtn" value="Vote" 
onclick="return rateItem(42504,2,true,true);" 
id="ctl00_RateArticle_SubmitRateBtn" class="button" type="submit">
			</td>
		
		</tr>
		</tbody></table>
		<span id="ctl00_RateArticle_ErrorMessage"></span>
	</td>
</tr>
</tbody></table>

<div class="RateComDiv" id="RCD" style="display: none;">
	<table width="100%"><tbody><tr valign="top"><td width="100%" 
align="right">Your reason for this vote:</td>
	<td><textarea class="RateComment" rows="5" cols="60" style="width: 
285px; float: right;"></textarea>
	</td></tr></tbody></table>
</div>

</div>
</td>
	</tr>
</tbody></table>

	</form>
	
	<div style="margin-left: 40px; padding: 10px; white-space: nowrap; 
overflow: hidden;">		  
		<div id="ctl00_BottomAd" style="display: inline-block; width: 468px; 
height: 60px;" title=""><iframe 
src="ExcelFormat.aspx_files/ServeFlash_002.htm" width="468px" 
frameborder="0" height="60px" scrolling="no"></iframe></div>
		
	</div>

	<a name="_comments"></a><!-- Forum Start -->
<div id="_MessageBoard" onclick="return SwitchMessage(event, null)">
	<table id="ForumTable" class="box theme3-background theme1-border 
fixed-layout tight" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
				<tbody><tr class="forum-header1">
					<td style="white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/forum_faq.gif" alt="FAQ" width="16px" 
align="middle" border="0" height="16px">&nbsp;<a 
href="http://www.codeproject.com/KB/FAQs/MessageBoardsFAQ.aspx"><b>FAQ</b></a>&nbsp;</td><td
 colspan="2" style="white-space: nowrap; text-align: right;"><form 
action="/script/Forums/Search.aspx?fid=0" method="get" style="margin: 
0pt; padding: 0pt;">
						<input name="fid" value="1549560" type="hidden"><input 
class="Frm_Input" name="kw" type="text">&nbsp;<input value="Search" 
name="FrmSrch" class="button" type="submit">
					</form></td>
				</tr><tr class="forum-header2">
					<td colspan="3" style="width: 100%;"><div style="text-align: 
right;">
						<form 
action="/script/Forums/SetOptions.aspx?floc=%2fKB%2foffice%2fExcelFormat.aspx&amp;fid=1549560"
 method="get" style="margin: 0pt; padding: 0pt;">
							<input name="fid" value="1549560" type="hidden"><input 
name="currentQS" 
value="?floc=%2fKB%2foffice%2fExcelFormat.aspx&amp;fid=1549560" 
type="hidden"><input name="floc" value="/KB/office/ExcelFormat.aspx" 
type="hidden">Noise Tolerance<select size="1" class="Frm_DropDown" 
name="noise">
								<option value="1">Very High</option><option value="2">High</option><option
 selected="selected" value="3">Medium</option><option value="4">Low</option><option
 value="5">Very Low</option>
							</select>&nbsp;&nbsp;Layout<select size="1" class="Frm_DropDown" 
name="view">
								<option selected="selected" value="Quick">Normal</option><option
 value="Topic">Expand Posts only</option><option value="Expanded">Expand
 Posts &amp; Replies</option><option value="Thread">Thread View</option><option
 value="Normal">No Javascript</option><option value="Preview">No JS + 
Preview</option>
							</select>&nbsp;&nbsp;Per page<select size="1" 
class="Frm_DropDown" name="mpp">
								<option value="10">10</option><option selected="selected" 
value="25">25</option><option value="50">50</option>
							</select>&nbsp;&nbsp;&nbsp;<input value="Update" name="SetOpt" 
class="button" type="submit">
						</form>
					</div></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><a name="xx0xx"></a><table width="100%" border="0" 
cellpadding="2px" cellspacing="0">
				<tbody><tr class="forum-navbar">
					<td><img src="ExcelFormat.aspx_files/forum_newmsg.gif" alt="new" 
width="16px" align="top" border="0" height="16px"><a 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;floc=/KB/office/ExcelFormat.aspx"
 class="toolbar" name="Frm_HoverNL" title="Create a new message thread" 
target="_top"><b>New Message</b></a></td><td>Msgs 1 to 25 of 65 (Total 
in Forum: 65) (<a 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560">Refresh</a>)</td><td
 style="text-align: right; white-space: nowrap;"><span class="toolbar">First</span><span
 class="toolbar">Prev</span><a class="toolbar" name="Frm_HoverNL" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;fr=26#xx0xx">Next</a></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table class="fixed-layout blank-background" width="100%" 
border="0" cellpadding="0" cellspacing="0">
				<tbody><tr>
					<td><img src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" 
border="0" height="5px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3456911_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3456911xx"></a><img
 src="ExcelFormat.aspx_files/msg_question.gif" alt="Question" 
width="16px" align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3456911" 
href="http://www.codeproject.com/Messages/3456911/Exception-uncaught.aspx">Exception
 uncaught</a> <a onclick="return Pin(this);" href="#" title="Click to 
pin message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6867147">sachatouille</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">1:31
 30 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3456911_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi All  <img 
src="ExcelFormat.aspx_files/smiley_smile.gif" alt="Smile" align="top">  <br><br>In
 the function below, an exception is launch when col is compared to 
maxCols_.<br>I use VC 2008 express in release mode. When I execute the 
progam step by step, VC2008 is not able to evaluate MaxCols_.<br><br>Did
 you already encounter this problem ? Or do you have an idea about the 
problem ?<br><br>Many thanks<br>Sacha<br><br><code><span 
class="code-comment">//</span><span class="code-comment"> Return a 
pointer to an Excel cell.<br></span><span class="code-comment">//</span><span
 class="code-comment"> row and col starts from 0.<br></span><span 
class="code-comment">//</span><span class="code-comment"> Returns 0 if 
row exceeds 65535 or col exceeds 255.<br></span>BasicExcelCell* 
BasicExcelWorksheet::Cell(size_t row, size_t col)<br>{<br>	<span 
class="code-comment">//</span><span class="code-comment"> Check to 
ensure row and col does not exceed maximum allowable range for an Excel 
worksheet.<br></span>	<span class="code-keyword">if</span> (row<span 
class="code-keyword">&gt;</span><span class="code-digit">65535</span> ||
 col<span class="code-keyword">&gt;</span><span class="code-digit">255</span>)
 <span class="code-keyword">return</span> <span class="code-digit">0</span>;<br><br>
	<span class="code-comment">//</span><span class="code-comment"> 
Increase size of cells matrix if necessary<br></span>	<span 
class="code-keyword">if</span> (col<span class="code-keyword">&gt;</span>=maxCols_)<br>
	{<br>		<span class="code-comment">//</span><span class="code-comment"> 
Increase number of columns.<br></span>		maxCols_ = col + <span 
class="code-digit">1</span>;<br>		<span class="code-keyword">for</span> 
(size_t i=0; i<span class="code-keyword">&lt;</span>maxRows_; ++i) 
cells_[i].resize(maxCols_);<br>	}<br>	<span class="code-keyword">if</span>
 (row<span class="code-keyword">&gt;</span>=maxRows_)<br>	{<br>		<span 
class="code-comment">//</span><span class="code-comment"> Increase 
number of rows.<br></span>		maxRows_ = row + <span class="code-digit">1</span>;<br>
		cells_.resize(maxRows_, vector<span class="code-keyword">&lt;</span>BasicExcelCell<span
 class="code-keyword">&gt;</span>(maxCols_));<br>	}<br><br>	<span 
class="code-keyword">return</span> &amp;(cells_[row][col]);<br>}</code><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3456911&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3456911&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3456911"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3456911/Exception-uncaught.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3456911&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3456911" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6867147,3456911,false,"","","");
											</script>Rate this message: <a href="#xx3456911xx" 
onclick="RateMsg(6867147, 3456911,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3456911xx" title="vote this message a 1" 
onclick="RateMsg(6867147, 3456911, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3456911xx" title="vote this message a 2" 
onclick="RateMsg(6867147, 3456911, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3456911xx" title="vote this message a 3" 
onclick="RateMsg(6867147, 3456911, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3456911xx" title="vote this message a 4" 
onclick="RateMsg(6867147, 3456911, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3456911xx" title="vote this message a 5" 
onclick="RateMsg(6867147, 3456911, 5,0)"><b>5</b></a> <a 
href="#xx3456911xx" onclick="RateMsg(6867147, 3456911,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3457111_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3457111xx"></a><img
 src="ExcelFormat.aspx_files/msg_answer.gif" alt="Answer" width="16px" 
align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3457111" 
href="http://www.codeproject.com/Messages/3457111/Re-Exception-uncaught.aspx">Re:
 Exception uncaught</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6867147">sachatouille</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:43
 30 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3457111_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi again,<br><br>My problem is not still 
corrected but I found why..... I guess !<br><br>The problem is the 
pointer on the object sheet is not initialized. So it's normal to have 
maxCols_ which is not defined.<br><br>I'll continue to work on, and I'll
 let you inform soon the problem will be corrected.<br><br>Sacha<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3457111&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3457111&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3456911"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3457111/Re-Exception-uncaught.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3457111&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3457111" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6867147,3457111,false,"","","");
											</script>Rate this message: <a href="#xx3457111xx" 
onclick="RateMsg(6867147, 3457111,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3457111xx" title="vote this message a 1" 
onclick="RateMsg(6867147, 3457111, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3457111xx" title="vote this message a 2" 
onclick="RateMsg(6867147, 3457111, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3457111xx" title="vote this message a 3" 
onclick="RateMsg(6867147, 3457111, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3457111xx" title="vote this message a 4" 
onclick="RateMsg(6867147, 3457111, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3457111xx" title="vote this message a 5" 
onclick="RateMsg(6867147, 3457111, 5,0)"><b>5</b></a> <a 
href="#xx3457111xx" onclick="RateMsg(6867147, 3457111,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3431841_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3431841xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3431841" 
href="http://www.codeproject.com/Messages/3431841/Can-ExcelFormat-deal-with-24-bit-colors.aspx">Can
 ExcelFormat deal with 24-bit colors?</a> <a onclick="return Pin(this);"
 href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=4838723">RamonFHerrera</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:22
 8 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3431841_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">I am trying to clone an existent spreadsheet 
that has 3 shades of blue. I was looking through the ExcelFormat source 
and am under the impression that colors are somewhat forced to 2 bytes 
(16-bit color), with bit shifting and truncation.<br><br>See below the 
color table that comes with the library and the 3 shades of blue I need 
to use.<br><br>Thanks,<br><br>-Ramon<br><br>--------------------------------<br>
 // predefined Excel color definitions<br>enum EXCEL_COLORS {<br>	
EGA_BLACK	= 0,		// 000000H<br>	EGA_WHITE	= 1,		// FFFFFFH<br>	EGA_RED		=
 2,		// FF0000H<br>	EGA_GREEN	= 3,		// 00FF00H<br>	EGA_BLUE	= 4,		// 
0000FFH<br>	EGA_YELLOW	= 5,		// FFFF00H<br>	EGA_MAGENTA	= 6,		// FF00FFH<br>
	EGA_CYAN	= 7		// 00FFFFH<br>	/*<br>	LIGHT_BLUE	= xDBE5F1,	// DBE5F1H Ok<br>
	MEDIUM_BLUE	= xB8CCE4,	// B8CCE4H Ok<br>	DARK_BLUE	= x4F81BD	// 4F81BDH
 Ok<br>	*/<br>};<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3431841&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3431841&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3431841"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3431841/Can-ExcelFormat-deal-with-24-bit-colors.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3431841&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3431841" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(4838723,3431841,false,"","","");
											</script>Rate this message: <a href="#xx3431841xx" 
onclick="RateMsg(4838723, 3431841,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3431841xx" title="vote this message a 1" 
onclick="RateMsg(4838723, 3431841, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3431841xx" title="vote this message a 2" 
onclick="RateMsg(4838723, 3431841, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3431841xx" title="vote this message a 3" 
onclick="RateMsg(4838723, 3431841, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3431841xx" title="vote this message a 4" 
onclick="RateMsg(4838723, 3431841, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3431841xx" title="vote this message a 5" 
onclick="RateMsg(4838723, 3431841, 5,0)"><b>5</b></a> <a 
href="#xx3431841xx" onclick="RateMsg(4838723, 3431841,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3431834_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3431834xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3431834" 
href="http://www.codeproject.com/Messages/3431834/How-can-I-adjust-the-column-widths.aspx">How
 can I adjust the column widths?</a> <a onclick="return Pin(this);" 
href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=4838723">RamonFHerrera</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:17
 8 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3431834_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Newbie alert...<br><br>I found a previous 
thread that supposedly deals with column widths, but it seems posters 
changed topic.<br><br>How can I modify the default column widths?<br><br>TIA,<br><br>-Ramon<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3431834&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3431834&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3431834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3431834/How-can-I-adjust-the-column-widths.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3431834&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3431834" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(4838723,3431834,false,"","","");
											</script>Rate this message: <a href="#xx3431834xx" 
onclick="RateMsg(4838723, 3431834,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3431834xx" title="vote this message a 1" 
onclick="RateMsg(4838723, 3431834, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3431834xx" title="vote this message a 2" 
onclick="RateMsg(4838723, 3431834, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3431834xx" title="vote this message a 3" 
onclick="RateMsg(4838723, 3431834, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3431834xx" title="vote this message a 4" 
onclick="RateMsg(4838723, 3431834, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3431834xx" title="vote this message a 5" 
onclick="RateMsg(4838723, 3431834, 5,0)"><b>5</b></a> <a 
href="#xx3431834xx" onclick="RateMsg(4838723, 3431834,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3433382_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3433382xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3433382" 
href="http://www.codeproject.com/Messages/3433382/Re-How-can-I-adjust-the-column-widths.aspx">Re:
 How can I adjust the column widths?</a> <a onclick="return Pin(this);" 
href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6012265">cuongabcde</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">9:38
 9 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3433382_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi Ramon,<br>You can download the lastest 
version of BasicExel at: 
http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat/.<br>In this 
version, a BasicExcelWorksheet will has function: void SetColWidth(const
 size_t colindex , const short colwidth);<br><br>Goodluck to you!<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3433382&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3433382&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3431834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3433382/Re-How-can-I-adjust-the-column-widths.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3433382&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3433382" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6012265,3433382,false,"","","");
											</script>Rate this message: <a href="#xx3433382xx" 
onclick="RateMsg(6012265, 3433382,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3433382xx" title="vote this message a 1" 
onclick="RateMsg(6012265, 3433382, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3433382xx" title="vote this message a 2" 
onclick="RateMsg(6012265, 3433382, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3433382xx" title="vote this message a 3" 
onclick="RateMsg(6012265, 3433382, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3433382xx" title="vote this message a 4" 
onclick="RateMsg(6012265, 3433382, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3433382xx" title="vote this message a 5" 
onclick="RateMsg(6012265, 3433382, 5,0)"><b>5</b></a> <a 
href="#xx3433382xx" onclick="RateMsg(6012265, 3433382,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3433714_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="52px"><a name="xx3433714xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3433714" 
href="http://www.codeproject.com/Messages/3433714/Re-How-can-I-adjust-the-column-widths.aspx">Re:
 How can I adjust the column widths?</a> <a onclick="return Pin(this);" 
href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=4838723">RamonFHerrera</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">15:10
 9 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3433714_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 52px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="52px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Thanks, counga <img 
src="ExcelFormat.aspx_files/smiley_smile.gif" alt="Smile" align="top"> <br><br>It
 works perfectly. I simply downloaded the 2 *.cpp and the 2 header files
 from that site, and the SetColWidth() function works as expected. For 
some reason I have to multiply the number of pixels shown by Excel by 
the magic number 37.<br><br>Best regards,<br><br>-Ramon<br><br>ps: If I 
could only use 24 bit colors, I would stay with this library. Below is 
the next logical step for those wishing more functionality. This site 
was actually sponsored (they contributed Open Source Code, believe it or
 not) by Microsoft:<br><br><a href="http://poi.apache.org/spreadsheet/">http://poi.apache.org/spreadsheet/</a><a
 href="http://poi.apache.org/spreadsheet/" target="_blank" title="New 
Window"></a><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3433714&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3433714&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3431834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3433714/Re-How-can-I-adjust-the-column-widths.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3433714&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3433714" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(4838723,3433714,false,"","","");
											</script>Rate this message: <a href="#xx3433714xx" 
onclick="RateMsg(4838723, 3433714,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3433714xx" title="vote this message a 1" 
onclick="RateMsg(4838723, 3433714, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3433714xx" title="vote this message a 2" 
onclick="RateMsg(4838723, 3433714, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3433714xx" title="vote this message a 3" 
onclick="RateMsg(4838723, 3433714, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3433714xx" title="vote this message a 4" 
onclick="RateMsg(4838723, 3433714, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3433714xx" title="vote this message a 5" 
onclick="RateMsg(4838723, 3433714, 5,0)"><b>5</b></a> <a 
href="#xx3433714xx" onclick="RateMsg(4838723, 3433714,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3427904_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3427904xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3427904" 
href="http://www.codeproject.com/Messages/3427904/About-MergedCell.aspx">About
 MergedCell</a> <a onclick="return Pin(this);" href="#" title="Click to 
pin message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6012265">cuongabcde</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">10:32
 5 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3427904_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi Martin,<br> Thanks for your library to 
edit excel, It's very cool. I've a question for you, that I see the 
method merge cell in basicCell but I don't know how to use. Can you tell
 me how to use this method to merge 2 or more cell togerther??<br> 
Thanks again!<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3427904&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3427904&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3427904"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3427904/About-MergedCell.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3427904&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3427904" style="white-space: 
nowrap;">3.50/5 (2 votes) <script type="text/javascript">
												MsgVFrm(6012265,3427904,false,"","","");
											</script>Rate this message: <a href="#xx3427904xx" 
onclick="RateMsg(6012265, 3427904,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3427904xx" title="vote this message a 1" 
onclick="RateMsg(6012265, 3427904, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3427904xx" title="vote this message a 2" 
onclick="RateMsg(6012265, 3427904, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3427904xx" title="vote this message a 3" 
onclick="RateMsg(6012265, 3427904, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3427904xx" title="vote this message a 4" 
onclick="RateMsg(6012265, 3427904, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3427904xx" title="vote this message a 5" 
onclick="RateMsg(6012265, 3427904, 5,0)"><b>5</b></a> <a 
href="#xx3427904xx" onclick="RateMsg(6012265, 3427904,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3425675_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3425675xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3425675" 
href="http://www.codeproject.com/Messages/3425675/Im-getting-an-extra-in-the-formula-input-box.aspx">I'm
 getting an extra ' in the formula input box</a> <a onclick="return 
Pin(this);" href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=1780987">ihedvall</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:47
 2 Apr '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3425675_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">I'm getting an extra dot in the formula input
 box when I clicking on a formatted cell. If I use BasicExcel without 
formatting I don't get it. I tried the prebuilt executable with the same
 result.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3425675&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3425675&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3425675"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3425675/Im-getting-an-extra-in-the-formula-input-box.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3425675&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3425675" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(1780987,3425675,false,"","","");
											</script>Rate this message: <a href="#xx3425675xx" 
onclick="RateMsg(1780987, 3425675,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3425675xx" title="vote this message a 1" 
onclick="RateMsg(1780987, 3425675, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3425675xx" title="vote this message a 2" 
onclick="RateMsg(1780987, 3425675, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3425675xx" title="vote this message a 3" 
onclick="RateMsg(1780987, 3425675, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3425675xx" title="vote this message a 4" 
onclick="RateMsg(1780987, 3425675, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3425675xx" title="vote this message a 5" 
onclick="RateMsg(1780987, 3425675, 5,0)"><b>5</b></a> <a 
href="#xx3425675xx" onclick="RateMsg(1780987, 3425675,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3418056_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3418056xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3418056" 
href="http://www.codeproject.com/Messages/3418056/Thanks.aspx">Thanks!!!</a>
 <a onclick="return Pin(this);" href="#" title="Click to pin message"><img
 src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top"
 border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6987752">klimzzz</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">14:52
 26 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3418056_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">WOW! Thanks a lot!!!!!<img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="Thumbs Up" align="top"> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3418056&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3418056"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3418056/Thanks.aspx" 
title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3418056&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3418056" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6987752,3418056,false,"","","");
											</script>Rate this message: <a href="#xx3418056xx" 
onclick="RateMsg(6987752, 3418056,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3418056xx" title="vote this message a 1" 
onclick="RateMsg(6987752, 3418056, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3418056xx" title="vote this message a 2" 
onclick="RateMsg(6987752, 3418056, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3418056xx" title="vote this message a 3" 
onclick="RateMsg(6987752, 3418056, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3418056xx" title="vote this message a 4" 
onclick="RateMsg(6987752, 3418056, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3418056xx" title="vote this message a 5" 
onclick="RateMsg(6987752, 3418056, 5,0)"><b>5</b></a> <a 
href="#xx3418056xx" onclick="RateMsg(6987752, 3418056,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3413842_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3413842xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3413842" 
href="http://www.codeproject.com/Messages/3413842/Run-Time-check-failure-sharp1.aspx">Run-Time
 check failure #1</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=2033165">Member
 2033165</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">18:54 23 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3413842_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi,<br><br>I put the four source files, 
BasicExcel.hpp/.cpp, ExcelFormat.h/.cpp and Examples.cpp also into my 
project. When I run the project and the line, xls.SaveAs(path) for 
example1 is executed, the debug error dialog shows up as described 
below.<br><br>basicexcel.hpp<br>Line:318<br>Run-Time Check Failure #1 -A
 cast to a small data type has cause a loss of data ...<br><br>My IDE is
 VC++ 2005. Do you have any idea about it?<br><br>Thanks,<br>mcts<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3413842&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3413842&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3413842"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3413842/Run-Time-check-failure-sharp1.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3413842&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3413842" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(2033165,3413842,false,"","","");
											</script>Rate this message: <a href="#xx3413842xx" 
onclick="RateMsg(2033165, 3413842,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3413842xx" title="vote this message a 1" 
onclick="RateMsg(2033165, 3413842, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3413842xx" title="vote this message a 2" 
onclick="RateMsg(2033165, 3413842, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3413842xx" title="vote this message a 3" 
onclick="RateMsg(2033165, 3413842, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3413842xx" title="vote this message a 4" 
onclick="RateMsg(2033165, 3413842, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3413842xx" title="vote this message a 5" 
onclick="RateMsg(2033165, 3413842, 5,0)"><b>5</b></a> <a 
href="#xx3413842xx" onclick="RateMsg(2033165, 3413842,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3415231_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3415231xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3415231" 
href="http://www.codeproject.com/Messages/3415231/Re-Run-Time-check-failure-sharp1.aspx">Re:
 Run-Time check failure #1</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=155624">Martin
 Fuchs</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">14:29 24 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3415231_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Does the error also show up if you start a 
Release build instead of a Debug one?<br>It seams you are using the code
 contained in the ZIP download. Can you please try the new from this 
repository?<br><a 
href="http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat/">http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat/</a>[<a
 href="http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat/" 
target="_blank" title="New Window">^</a>]<br><br>Thanks,<br><br>    
Martin<br><div class="signature">Martin Fuchs<br>martin-fuchs@gmx.net</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3415231&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3415231&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3413842"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3415231/Re-Run-Time-check-failure-sharp1.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3415231&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3415231" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(155624,3415231,false,"","","");
											</script>Rate this message: <a href="#xx3415231xx" 
onclick="RateMsg(155624, 3415231,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3415231xx" title="vote this message a 1" 
onclick="RateMsg(155624, 3415231, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3415231xx" title="vote this message a 2" 
onclick="RateMsg(155624, 3415231, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3415231xx" title="vote this message a 3" 
onclick="RateMsg(155624, 3415231, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3415231xx" title="vote this message a 4" 
onclick="RateMsg(155624, 3415231, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3415231xx" title="vote this message a 5" 
onclick="RateMsg(155624, 3415231, 5,0)"><b>5</b></a> <a 
href="#xx3415231xx" onclick="RateMsg(155624, 3415231,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3418094_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="52px"><a name="xx3418094xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3418094" 
href="http://www.codeproject.com/Messages/3418094/Re-Run-Time-check-failure-sharp1.aspx">Re:
 Run-Time check failure #1</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=2033165">Member
 2033165</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">15:42 26 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3418094_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 52px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="52px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">No, it doesn't show up if I start your binary
 file, ExcelFormat.exe.<br>I have tried the new from that repository 
also, but the same problem exists.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3418094&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3418094&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3413842"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3418094/Re-Run-Time-check-failure-sharp1.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3418094&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3418094" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(2033165,3418094,false,"","","");
											</script>Rate this message: <a href="#xx3418094xx" 
onclick="RateMsg(2033165, 3418094,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3418094xx" title="vote this message a 1" 
onclick="RateMsg(2033165, 3418094, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3418094xx" title="vote this message a 2" 
onclick="RateMsg(2033165, 3418094, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3418094xx" title="vote this message a 3" 
onclick="RateMsg(2033165, 3418094, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3418094xx" title="vote this message a 4" 
onclick="RateMsg(2033165, 3418094, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3418094xx" title="vote this message a 5" 
onclick="RateMsg(2033165, 3418094, 5,0)"><b>5</b></a> <a 
href="#xx3418094xx" onclick="RateMsg(2033165, 3418094,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F3397290_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3397290xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3397290" 
href="http://www.codeproject.com/Messages/3397290/How-to-change-Column-Width.aspx">How
 to change Column Width</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=648208">MickeyJC</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">13:16
 9 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3397290_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">I have read previous replies regarding 
changing column width but still could not figure out how to do it. Can 
anyone please give me an example line on how to do it? Thanks.<br><br>BTW
 - When loading up a pre-formatted worksheet, I made some changes to it 
then did a Save(). The result was that there's no changes in the 
originally loaded file. If I did a SaveAs() then the changes were made 
to the sheet but the column widths were reset to default!<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3397290&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3397290&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3397290"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3397290/How-to-change-Column-Width.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3397290&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3397290" style="white-space: 
nowrap;">2.00/5 (1 vote) <script type="text/javascript">
												MsgVFrm(648208,3397290,false,"","","");
											</script>Rate this message: <a href="#xx3397290xx" 
onclick="RateMsg(648208, 3397290,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3397290xx" title="vote this message a 1" 
onclick="RateMsg(648208, 3397290, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3397290xx" title="vote this message a 2" 
onclick="RateMsg(648208, 3397290, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3397290xx" title="vote this message a 3" 
onclick="RateMsg(648208, 3397290, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3397290xx" title="vote this message a 4" 
onclick="RateMsg(648208, 3397290, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3397290xx" title="vote this message a 5" 
onclick="RateMsg(648208, 3397290, 5,0)"><b>5</b></a> <a 
href="#xx3397290xx" onclick="RateMsg(648208, 3397290,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3420420_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3420420xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3420420" 
href="http://www.codeproject.com/Messages/3420420/Re-How-to-change-Column-Width.aspx">Re:
 How to change Column Width</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=1780987">ihedvall</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">9:38
 29 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3420420_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">I updated the basicexcel.cpp/hpp and 
excelformat.cpp/h from the link: <a 
href="http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat">http://shell.franken.de/svn/sky/excel/trunk/ExcelFormat</a>
<br>I can Load in an XLT file and save it to an XLS file with the 
template formats. Note that there is some error with the Save() function
 so I used the SaveAs() function instead. I suspect that the source 
files are not updated.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3420420&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3420420&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3397290"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3420420/Re-How-to-change-Column-Width.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3420420&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3420420" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(1780987,3420420,false,"","","");
											</script>Rate this message: <a href="#xx3420420xx" 
onclick="RateMsg(1780987, 3420420,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3420420xx" title="vote this message a 1" 
onclick="RateMsg(1780987, 3420420, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3420420xx" title="vote this message a 2" 
onclick="RateMsg(1780987, 3420420, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3420420xx" title="vote this message a 3" 
onclick="RateMsg(1780987, 3420420, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3420420xx" title="vote this message a 4" 
onclick="RateMsg(1780987, 3420420, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3420420xx" title="vote this message a 5" 
onclick="RateMsg(1780987, 3420420, 5,0)"><b>5</b></a> <a 
href="#xx3420420xx" onclick="RateMsg(1780987, 3420420,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3356834_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3356834xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3356834" 
href="http://www.codeproject.com/Messages/3356834/Define-A-formula.aspx">Define
 A formula</a> <a onclick="return Pin(this);" href="#" title="Click to 
pin message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=753324">Rishi
 Kumar</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">22:32 4 Feb '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3356834_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Dear Sir,<br>I appreciate you post this 
useful article. But it has not any example for defining formula.<br>Kindly
 help me how to do this.<br>Thanks &amp; Best Regards<br>rishi<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356834&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356834&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3356834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3356834/Define-A-formula.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3356834&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3356834" style="white-space: 
nowrap;">3.00/5 (1 vote) <script type="text/javascript">
												MsgVFrm(753324,3356834,false,"","","");
											</script>Rate this message: <a href="#xx3356834xx" 
onclick="RateMsg(753324, 3356834,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3356834xx" title="vote this message a 1" 
onclick="RateMsg(753324, 3356834, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3356834xx" title="vote this message a 2" 
onclick="RateMsg(753324, 3356834, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3356834xx" title="vote this message a 3" 
onclick="RateMsg(753324, 3356834, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3356834xx" title="vote this message a 4" 
onclick="RateMsg(753324, 3356834, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3356834xx" title="vote this message a 5" 
onclick="RateMsg(753324, 3356834, 5,0)"><b>5</b></a> <a 
href="#xx3356834xx" onclick="RateMsg(753324, 3356834,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3356931_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3356931xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3356931" 
href="http://www.codeproject.com/Messages/3356931/Re-Define-A-formula.aspx">Re:
 Define A formula</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=155624">Martin
 Fuchs</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">23:58 4 Feb '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3356931_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Yes, sorry to disappoint you. But creating 
new formulas is not possible with this library. <br><br><div 
class="signature">Martin Fuchs<br>martin-fuchs@gmx.net</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356931&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356931&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3356834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3356931/Re-Define-A-formula.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3356931&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3356931" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(155624,3356931,false,"","","");
											</script>Rate this message: <a href="#xx3356931xx" 
onclick="RateMsg(155624, 3356931,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3356931xx" title="vote this message a 1" 
onclick="RateMsg(155624, 3356931, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3356931xx" title="vote this message a 2" 
onclick="RateMsg(155624, 3356931, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3356931xx" title="vote this message a 3" 
onclick="RateMsg(155624, 3356931, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3356931xx" title="vote this message a 4" 
onclick="RateMsg(155624, 3356931, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3356931xx" title="vote this message a 5" 
onclick="RateMsg(155624, 3356931, 5,0)"><b>5</b></a> <a 
href="#xx3356931xx" onclick="RateMsg(155624, 3356931,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3356980_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="52px"><a name="xx3356980xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3356980" 
href="http://www.codeproject.com/Messages/3356980/Re-Define-A-formula.aspx">Re:
 Define A formula</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=753324">Rishi
 Kumar</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">0:44 5 Feb '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3356980_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 52px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="52px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Thanks for reply.<br>how I can initilize 
following object?<br><br>Worksheet::CellTable::RowBlock::CellBlock::Formula
 f<br><br>With Best Regards<br>Rishi<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356980&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3356980&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3356834"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3356980/Re-Define-A-formula.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3356980&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3356980" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(753324,3356980,false,"","","");
											</script>Rate this message: <a href="#xx3356980xx" 
onclick="RateMsg(753324, 3356980,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3356980xx" title="vote this message a 1" 
onclick="RateMsg(753324, 3356980, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3356980xx" title="vote this message a 2" 
onclick="RateMsg(753324, 3356980, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3356980xx" title="vote this message a 3" 
onclick="RateMsg(753324, 3356980, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3356980xx" title="vote this message a 4" 
onclick="RateMsg(753324, 3356980, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3356980xx" title="vote this message a 5" 
onclick="RateMsg(753324, 3356980, 5,0)"><b>5</b></a> <a 
href="#xx3356980xx" onclick="RateMsg(753324, 3356980,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel " id="F3348259_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3348259xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3348259" 
href="http://www.codeproject.com/Messages/3348259/Copy-macros.aspx">Copy
 macros</a> <a onclick="return Pin(this);" href="#" title="Click to pin 
message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=4479508">MyIQQ</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:47
 28 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3348259_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi Martin Fuchs,<br>I have a trouble as below
 :<br>I have a source file xls which has a button with macro, I want to 
add integer data to it and save, but after saving, the button with macro
 is disappear, I think your library don't support for macro, so Can you 
teach me how to save the button with macro ?<br><br>Thank and best 
regards,<br>MyIQQ<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3348259&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3348259&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3348259"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3348259/Copy-macros.aspx" 
title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3348259&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3348259" style="white-space: 
nowrap;">1.00/5 (1 vote) <script type="text/javascript">
												MsgVFrm(4479508,3348259,false,"","","");
											</script>Rate this message: <a href="#xx3348259xx" 
onclick="RateMsg(4479508, 3348259,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3348259xx" title="vote this message a 1" 
onclick="RateMsg(4479508, 3348259, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3348259xx" title="vote this message a 2" 
onclick="RateMsg(4479508, 3348259, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3348259xx" title="vote this message a 3" 
onclick="RateMsg(4479508, 3348259, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3348259xx" title="vote this message a 4" 
onclick="RateMsg(4479508, 3348259, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3348259xx" title="vote this message a 5" 
onclick="RateMsg(4479508, 3348259, 5,0)"><b>5</b></a> <a 
href="#xx3348259xx" onclick="RateMsg(4479508, 3348259,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3410866_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3410866xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3410866" 
href="http://www.codeproject.com/Messages/3410866/Re-Copy-macros.aspx">Re:
 Copy macros</a> <a onclick="return Pin(this);" href="#" title="Click to
 pin message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=155624">Martin
 Fuchs</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">9:56 21 Mar '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3410866_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hello,<br><br>sorry there is currently no 
support to handle macros. You might switch to OLE Automation for 
controlling MS Excel if you need this advanced features.<br><br>Regards,<br><br>
   Martin<br><div class="signature">Martin Fuchs<br>martin-fuchs@gmx.net</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3410866&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3410866&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3348259"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3410866/Re-Copy-macros.aspx" 
title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3410866&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3410866" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(155624,3410866,false,"","","");
											</script>Rate this message: <a href="#xx3410866xx" 
onclick="RateMsg(155624, 3410866,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3410866xx" title="vote this message a 1" 
onclick="RateMsg(155624, 3410866, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3410866xx" title="vote this message a 2" 
onclick="RateMsg(155624, 3410866, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3410866xx" title="vote this message a 3" 
onclick="RateMsg(155624, 3410866, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3410866xx" title="vote this message a 4" 
onclick="RateMsg(155624, 3410866, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3410866xx" title="vote this message a 5" 
onclick="RateMsg(155624, 3410866, 5,0)"><b>5</b></a> <a 
href="#xx3410866xx" onclick="RateMsg(155624, 3410866,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3344662_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3344662xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3344662" 
href="http://www.codeproject.com/Messages/3344662/Cannot-handle-large-data-sheets-and-is-painfuly-sl.aspx">Cannot
 handle large data sheets and is painfuly slow</a> <a onclick="return 
Pin(this);" href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=1079658">Turms</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">23:59
 25 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3344662_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hi<br><br>In general I think the proposed lib
 is good however it has some major bugs. I've just tested it and have 
some cons:-<br>1) it cannot handle large data sheets, e.g. 20-30k 
entries. there appear lots of memory leaks!<br>2) the lib is slow, very 
slow. just try to write 3-4k entries in a sheet.<br><br>I tested it with
 the latest code from SVN. Hope the bugs are not serious and someone 
will clear it soon <img src="ExcelFormat.aspx_files/smiley_smile.gif" 
alt="Smile" align="top"> .<br><br>sincerly<br>turms<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3344662&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3344662&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3344662"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3344662/Cannot-handle-large-data-sheets-and-is-painfuly-sl.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3344662&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3344662" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(1079658,3344662,false,"","","");
											</script>Rate this message: <a href="#xx3344662xx" 
onclick="RateMsg(1079658, 3344662,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3344662xx" title="vote this message a 1" 
onclick="RateMsg(1079658, 3344662, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3344662xx" title="vote this message a 2" 
onclick="RateMsg(1079658, 3344662, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3344662xx" title="vote this message a 3" 
onclick="RateMsg(1079658, 3344662, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3344662xx" title="vote this message a 4" 
onclick="RateMsg(1079658, 3344662, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3344662xx" title="vote this message a 5" 
onclick="RateMsg(1079658, 3344662, 5,0)"><b>5</b></a> <a 
href="#xx3344662xx" onclick="RateMsg(1079658, 3344662,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3354660_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3354660xx"></a><img
 src="ExcelFormat.aspx_files/msg_news.gif" alt="News" width="16px" 
align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3354660" 
href="http://www.codeproject.com/Messages/3354660/Re-Cannot-handle-large-data-sheets-and-is-painfuly.aspx">Re:
 Cannot handle large data sheets and is painfuly slow</a> <a 
onclick="return Pin(this);" href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/group_sm.gif" title="group" 
alt="group" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=3796799">chipmunk</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">7:25
 3 Feb '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3354660_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Please try our library <a 
href="http://www.libxl.com/">http://www.libxl.com</a> for 
reading/writing xls files. It handles large data sheets with good 
performance.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3354660&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3354660&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3344662"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3354660/Re-Cannot-handle-large-data-sheets-and-is-painfuly.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3354660&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3354660" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(3796799,3354660,false,"","","");
											</script>Rate this message: <a href="#xx3354660xx" 
onclick="RateMsg(3796799, 3354660,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3354660xx" title="vote this message a 1" 
onclick="RateMsg(3796799, 3354660, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3354660xx" title="vote this message a 2" 
onclick="RateMsg(3796799, 3354660, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3354660xx" title="vote this message a 3" 
onclick="RateMsg(3796799, 3354660, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3354660xx" title="vote this message a 4" 
onclick="RateMsg(3796799, 3354660, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3354660xx" title="vote this message a 5" 
onclick="RateMsg(3796799, 3354660, 5,0)"><b>5</b></a> <a 
href="#xx3354660xx" onclick="RateMsg(3796799, 3354660,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3339865_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3339865xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3339865" 
href="http://www.codeproject.com/Messages/3339865/translation-date-contents.aspx">translation
 date contents</a> <a onclick="return Pin(this);" href="#" title="Click 
to pin message"><img src="ExcelFormat.aspx_files/pin.gif" alt="Pin" 
width="13px" align="top" border="0" height="12px"></a></td><td 
style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6878027">josp.jorge</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">6:22
 21 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3339865_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hello, how do I identify that a cell contains
 a date or date-time value and how it is translated into its components 
year,month,day, etc ?<br><br>Thanks and best regards,<br><br>Jorge<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3339865&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3339865&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3339865"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3339865/translation-date-contents.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3339865&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3339865" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6878027,3339865,false,"","","");
											</script>Rate this message: <a href="#xx3339865xx" 
onclick="RateMsg(6878027, 3339865,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3339865xx" title="vote this message a 1" 
onclick="RateMsg(6878027, 3339865, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3339865xx" title="vote this message a 2" 
onclick="RateMsg(6878027, 3339865, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3339865xx" title="vote this message a 3" 
onclick="RateMsg(6878027, 3339865, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3339865xx" title="vote this message a 4" 
onclick="RateMsg(6878027, 3339865, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3339865xx" title="vote this message a 5" 
onclick="RateMsg(6878027, 3339865, 5,0)"><b>5</b></a> <a 
href="#xx3339865xx" onclick="RateMsg(6878027, 3339865,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3342360_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3342360xx"></a><img
 src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px"
 align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3342360" 
href="http://www.codeproject.com/Messages/3342360/Re-translation-date-contents.aspx">Re:
 translation date contents</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=155624">Martin
 Fuchs</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">13:58 23 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3342360_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hello,<br><br>you can use the <code>CellFormat::get_format_string()</code>
 function to retrieve the cell format string. Then you can query this 
string for date components like "YY" to decide if the cell contains a 
date. Here is a little example that shows how to get the format string 
of a cell:<br><br><pre> BasicExcelCell* cell = sheet-&gt;Cell(y, x);<br><br> CellFormat fmt(fmt_mgr, cell);<br><br> <span class="code-keyword">const</span> wstring&amp; fmt_string = fmt.get_format_string();<br> cout <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> <span class="code-string">"</span><span class="code-string"> cell content: "</span> <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> cell-&gt;GetString() <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> endl;<br> cout <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> <span class="code-string">"</span><span class="code-string"> cell format: "</span> <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> narrow_string(fmt_string) <span class="code-keyword">&lt;</span><span class="code-keyword">&lt;</span> endl;</pre>
Evaluating the date is then just a matter of parsing the cell content as
 a string value.<br><br>Regards,<br><br>   Martin <br><br><div 
class="signature">Martin Fuchs<br>martin-fuchs@gmx.net</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3342360&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3342360&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3339865"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3342360/Re-translation-date-contents.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3342360&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3342360" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(155624,3342360,false,"","","");
											</script>Rate this message: <a href="#xx3342360xx" 
onclick="RateMsg(155624, 3342360,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3342360xx" title="vote this message a 1" 
onclick="RateMsg(155624, 3342360, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3342360xx" title="vote this message a 2" 
onclick="RateMsg(155624, 3342360, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3342360xx" title="vote this message a 3" 
onclick="RateMsg(155624, 3342360, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3342360xx" title="vote this message a 4" 
onclick="RateMsg(155624, 3342360, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3342360xx" title="vote this message a 5" 
onclick="RateMsg(155624, 3342360, 5,0)"><b>5</b></a> <a 
href="#xx3342360xx" onclick="RateMsg(155624, 3342360,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="root msg-divide"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" border="0" 
height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel " id="F3339265_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="16px"><a name="xx3339265xx"></a><img
 src="ExcelFormat.aspx_files/msg_question.gif" alt="Question" 
width="16px" align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3339265" 
href="http://www.codeproject.com/Messages/3339265/Load-unhandled-exception-help.aspx">Load
 unhandled exception, help</a> <a onclick="return Pin(this);" href="#" 
title="Click to pin message"><img src="ExcelFormat.aspx_files/pin.gif" 
alt="Pin" width="13px" align="top" border="0" height="12px"></a></td><td
 style="width: 20px; white-space: nowrap;"><img 
src="ExcelFormat.aspx_files/member_sm.gif" title="member" alt="member" 
border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=6875344">whohaha</a></td><td
 class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">22:48
 20 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3339265_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="16px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">hello<br>I use the BasicExcel Library to read
 data from .xls file,first i should load data from the file.It does work
 well.<br>But,i have a problem now.<br>I load some .xls file,and the 
load function come to an unhandle exception.I don't know why it comes to
 exception.<br>Will you help me?<br>Thanks every much.<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3339265&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3339265&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3339265"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3339265/Load-unhandled-exception-help.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3339265&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3339265" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(6875344,3339265,false,"","","");
											</script>Rate this message: <a href="#xx3339265xx" 
onclick="RateMsg(6875344, 3339265,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3339265xx" title="vote this message a 1" 
onclick="RateMsg(6875344, 3339265, 1,0)"><b>1</b></a> <a class="toolbar"
 href="#xx3339265xx" title="vote this message a 2" 
onclick="RateMsg(6875344, 3339265, 2,0)"><b>2</b></a> <a class="toolbar"
 href="#xx3339265xx" title="vote this message a 3" 
onclick="RateMsg(6875344, 3339265, 3,0)"><b>3</b></a> <a class="toolbar"
 href="#xx3339265xx" title="vote this message a 4" 
onclick="RateMsg(6875344, 3339265, 4,0)"><b>4</b></a> <a class="toolbar"
 href="#xx3339265xx" title="vote this message a 5" 
onclick="RateMsg(6875344, 3339265, 5,0)"><b>5</b></a> <a 
href="#xx3339265xx" onclick="RateMsg(6875344, 3339265,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="quick">
					<td class="msg-divide"><img src="ExcelFormat.aspx_files/t_002.gif" 
alt="" width="1px" border="0" height="1px"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel " id="F3342348_h0">
					<td width="100%"><table class="quickHd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr class="hover-row">
							<td class="Frm_MsgIndent" width="34px"><a name="xx3342348xx"></a><img
 src="ExcelFormat.aspx_files/msg_answer.gif" alt="Answer" width="16px" 
align="top" height="16px"></td><td class="Frm_MsgSubject 
hover-container"><a id="DynMessLink" name="3342348" 
href="http://www.codeproject.com/Messages/3342348/Re-Load-unhandled-exception-help.aspx">Re:
 Load unhandled exception, help</a> <a onclick="return Pin(this);" 
href="#" title="Click to pin message"><img 
src="ExcelFormat.aspx_files/pin.gif" alt="Pin" width="13px" align="top" 
border="0" height="12px"></a></td><td style="width: 20px; white-space: 
nowrap;"><img src="ExcelFormat.aspx_files/member_sm.gif" title="member" 
alt="member" border="0" height="16px"></td><td class="Frm_MsgAuthor"><a 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=155624">Martin
 Fuchs</a></td><td class="Frm_MsgDate" style="vertical-align: top; 
white-space: nowrap;">13:32 23 Jan '10 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F3342348_h1" style="display: none;">
					<td width="100%"><table class="quickBd" width="100%" border="0" 
cellpadding="0" cellspacing="0">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"><img 
src="ExcelFormat.aspx_files/t_002.gif" alt="" width="34px" height="1px"></td><td
 class="MsgBd BdSel "><table width="100%" border="0" cellpadding="0" 
cellspacing="5px">
								<tbody><tr>
									<td><table width="100%" border="0" cellpadding="0" 
cellspacing="0">
										<tbody><tr>
											<td colspan="2">Hello, if you send me your test file, I will 
have a look at it. May be debugging will show the source of the problem.<br><br>Regards,<br><br>
   Martin <br><br><div class="signature">Martin Fuchs<br>martin-fuchs@gmx.net</div><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="msg-footer"><a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3342348&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=r"
 title="Reply">Reply</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=1549560&amp;select=3342348&amp;floc=/KB/office/ExcelFormat.aspx&amp;action=e"
 title="Email">Email</a>·<a class="toolbar" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;tid=3339265"
 title="View&nbsp;Thread">View&nbsp;Thread</a>·<a class="toolbar" 
href="http://www.codeproject.com/Messages/3342348/Re-Load-unhandled-exception-help.aspx"
 title="Get permanent link">PermaLink</a>·<a class="toolbar" 
href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3342348&amp;obtid=3&amp;action=AddBookmark"
 title="Bookmark this post">Bookmark</a></td><td class="msg-footer" 
style="text-align: right;"><span id="MVF3342348" style="white-space: 
nowrap;"><script type="text/javascript">
												MsgVFrm(155624,3342348,false,"","","");
											</script>Rate this message: <a href="#xx3342348xx" 
onclick="RateMsg(155624, 3342348,1,0);"><img 
src="ExcelFormat.aspx_files/thumbs_down.gif" alt="vote 1" width="14" 
align="middle" border="0" height="14"></a> <a class="toolbar" 
href="#xx3342348xx" title="vote this message a 1" 
onclick="RateMsg(155624, 3342348, 1,0)"><b>1</b></a> <a class="toolbar" 
href="#xx3342348xx" title="vote this message a 2" 
onclick="RateMsg(155624, 3342348, 2,0)"><b>2</b></a> <a class="toolbar" 
href="#xx3342348xx" title="vote this message a 3" 
onclick="RateMsg(155624, 3342348, 3,0)"><b>3</b></a> <a class="toolbar" 
href="#xx3342348xx" title="vote this message a 4" 
onclick="RateMsg(155624, 3342348, 4,0)"><b>4</b></a> <a class="toolbar" 
href="#xx3342348xx" title="vote this message a 5" 
onclick="RateMsg(155624, 3342348, 5,0)"><b>5</b></a> <a 
href="#xx3342348xx" onclick="RateMsg(155624, 3342348,5,0);"><img 
src="ExcelFormat.aspx_files/thumbs_up.gif" alt="vote 5" width="14" 
align="middle" border="0" height="14"></a> </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr>
					<td><img src="ExcelFormat.aspx_files/t_002.gif" alt="" width="1px" 
border="0" height="5px"></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table width="100%" cellpadding="2px" cellspacing="0">
				<tbody><tr class="forum-footer">
					<td>Last Visit: 16:48 8 May '10  &nbsp; &nbsp; Last Update: 18:14 8
 May '10 </td><td style="text-align: right; white-space: nowrap;"><input
 id="_mbnUrl" value="/KB/office/ExcelFormat.aspx?fid=1549560&amp;fr=26" 
type="hidden"><b>1</b><a class="toolbar" name="Frm_HoverNL" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;fr=26#xx0xx">2</a><a
 class="toolbar" name="Frm_HoverNL" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;fr=51#xx0xx">3</a>
 <a class="toolbar" name="Frm_HoverNL" 
href="http://www.codeproject.com/KB/office/ExcelFormat.aspx?fid=1549560&amp;fr=26#xx0xx">Next
 »</a></td>
				</tr>
			</tbody></table></td>
		</tr>
	</tbody></table>
</div><p class="small-text"><img 
src="ExcelFormat.aspx_files/msg_general.gif" alt="General" width="16px" 
align="top" height="16px"> General &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_news.gif" alt="News" width="16px" 
align="top" height="16px"> News &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_question.gif" alt="Question" 
width="16px" align="top" height="16px"> Question &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_answer.gif" alt="Answer" width="16px" 
align="top" height="16px"> Answer &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_joke.gif" alt="Joke" width="16px" 
align="top" height="16px"> Joke &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_rant.gif" alt="Rant" width="16px" 
align="top" height="16px"> Rant &nbsp;&nbsp; <img 
src="ExcelFormat.aspx_files/msg_admin.gif" alt="Admin" width="16px" 
align="top" height="16px"> Admin &nbsp;&nbsp; </p><p class="small-text">Use
 Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, 
Ctrl+PgUp/PgDown to switch pages.</p>
<!-- Forum End -->




	
	</div>
	
	
	
	<table width="100%">
	<tbody><tr valign="top">
		<td class="tiny-text" align="left">
		    <a id="ctl00_PermaLink" 
href="http://www.codeproject.com/script/Articles/Article.aspx?aid=42504">PermaLink</a>
 | 
			<a id="ctl00_PrivacyLink" 
href="http://www.codeproject.com/info/privacy.aspx">Privacy</a> |
			<a id="ctl00_TermsOfUseLink" 
href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a>
			<br>Last Updated: 12 Jan 2010<br>
			Editor: <a id="ctl00_ArticleEditor" 
href="http://www.codeproject.com/script/Membership/View.aspx?mid=3873871">Sean
 Ewington</a><br>
		</td>
		<td class="tiny-text" valign="top" align="right">
			Copyright 2009 by Martin Fuchs<br>Everything else
			Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>,
 1999-2010 <br>
			Web18 |
			<a id="ctl00_AdvertiseLink" 
href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on the 
Code Project </a>
		</td>
	</tr>
	
	</tbody></table>
	
	<center>
		
	</center>

</div>
</div>	
	
<div>


</div>

<br>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/oncopy.js"></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/TogglePre.js"></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/jquery-1.js"></script><script type="text/javascript">//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='/script/JS/jquery-1.3.2.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/JobsSummaryRetriever.js"></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/addto.js"></script>
<script type="text/javascript" language="Javascript" src="ExcelFormat.aspx_files/ShortCuts.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
var e=document;
if(e){if(document.all)try{e.attachEvent('onkeydown',LK);}catch(ex){} 
else e.addEventListener('keydown',LK, false);}

var e=document;
if(e){if(document.all)try{e.attachEvent('onkeyup',LK);}catch(ex){} 
else e.addEventListener('keyup',LK, false);}

var e=document;
if(e){if(document.all)try{e.attachEvent('onblur',LK);}catch(ex){} 
else e.addEventListener('blur',LK, false);}

var e=document.getElementById('ctl00_TopNavBar_Lounge');
if(e){if(document.all)try{e.attachEvent('onclick',LC);}catch(ex){} 
else e.addEventListener('click',LC, false);}

var e=document.getElementById('ctl00_TopNavBar_Soapbox');
if(e){if(document.all)try{e.attachEvent('onclick',LC);}catch(ex){} 
else e.addEventListener('click',LC, false);}

$(document).ready(function() {RetrieveJobsSummary('Th',42504,2,48,"4,5,7,9,78,94,118,153,239");});
var socialLinks = new social();
socialLinks.PlaceholderId="ATD";socialLinks.ObjectId=42504;
socialLinks.ObjectTypeId=2;
socialLinks.addtoMethod=1;
socialLinks.Horizontal=false;
socialLinks.Showname=true;
socialLinks.setupLinks("socialLinks", document.location.href,escape(document.title), 100, 0, "small-text Bold", "AddTo");
socialLinks.setupMenu();
$(function() {
  var postData = '{ "impressions": [{"AdvertisementId":13133,"CreativeId":11628,"IsCrawler":false,"ObjectId":42504,"ObjectTypeId":2},{"AdvertisementId":12867,"CreativeId":11897,"IsCrawler":false,"ObjectId":42504,"ObjectTypeId":2},{"AdvertisementId":13362,"CreativeId":12164,"IsCrawler":false,"ObjectId":42504,"ObjectTypeId":2},{"AdvertisementId":13687,"CreativeId":12373,"IsCrawler":false,"ObjectId":42504,"ObjectTypeId":2},{"AdvertisementId":14146,"CreativeId":12588,"IsCrawler":false,"ObjectId":42504,"ObjectTypeId":2}]}';
                $.ajax({
                    type: 'POST',
                    cache: false,
                    url: '/script/AdServe/WebServices/AdServices.aspx/RecordImpressions',
                    data: postData,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',success: function(msg) {
                    }
                });});

$( function() { $('#ctl00_TopAd').attr('src','/script/AdServe/ServeImg.aspx?C=False&adcrid=11628&adid=13133&obid=42504&obtid=2' );});
$(function() { $("#ctl00_LeftHandAd").html(unescape("%3cIFRAME%20src=%22/script/AdServe/ServeFlash.aspx?C=False&adcrid=12164&adid=13362&obid=42504&obtid=2%22 frameborder=%220%22 scrolling=%22no%22 width=%22150px%22 height=%2280px%22%3e%3c/IFRAME%3e"));});
$( function() { $('#ctl00_TowerAd').attr('src','/script/AdServe/ServeImg.aspx?C=False&adcrid=12373&adid=13687&obid=42504&obtid=2' );});
$(function() { $("#ctl00_AdWords").html(unescape("%3cIFRAME%20src=%22/script/AdServe/ServeHtml.aspx?C=False&adcrid=12588&adid=14146&obid=42504&obtid=2%22 frameborder=%220%22 scrolling=%22no%22 width=%22300px%22 height=%22250px%22%3e%3c/IFRAME%3e"));});
$('#ctl00_RateArticle_RateItemWrapper').css('display', '');
function ChkRtctl00_RateArticle(val, objId) {if (val<=2) {$('div[name=RateItem_' + objId + '] .RateComDiv').css("display","");}else $('div[name=RateItem_' + objId + '] .RateComDiv').css("display","none");}
$(function() { $("#ctl00_BottomAd").html(unescape("%3cIFRAME%20src=%22/script/AdServe/ServeFlash.aspx?C=False&adcrid=11897&adid=12867&obid=42504&obtid=2%22 frameborder=%220%22 scrolling=%22no%22 width=%22468px%22 height=%2260px%22%3e%3c/IFRAME%3e"));});

//]]>
</script>



<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script>

<div style="position: absolute; display: none; z-index: 9999;" 
id="livemargins_control"><img 
src="ExcelFormat.aspx_files/monitor-background-horizontal.png" 
style="position: absolute; left: -77px; top: -5px;" width="77" 
height="5">	<img 
src="ExcelFormat.aspx_files/monitor-background-vertical.png" 
style="position: absolute; left: 0pt; top: -5px;">	<img 
id="monitor-play-button" 
src="ExcelFormat.aspx_files/monitor-play-button.png" 
onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0.5" 
style="position: absolute; left: 1px; top: 0pt; opacity: 0.5; cursor: 
pointer;"></div></body></html>